<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>í˜„ëŒ€ê±´ì„¤ ê²½ì˜ì‹¤ì  ëŒ€ì‹œë³´ë“œ '26ë…„ 01ì›”ë§</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
:root {
  --bg: #f0f4f8;
  --bg-card: #ffffff;
  --bg-nav: #1a2b4a;
  --bg-nav-hover: #243660;
  --bg-topbar: #ffffff;
  --border: #e2e8f0;
  --border-nav: rgba(255,255,255,0.1);
  --accent: #1a56db;
  --accent-dark: #1340b0;
  --accent2: #f59e0b;
  --accent3: #10b981;
  --red: #ef4444;
  --text-primary: #1e293b;
  --text-secondary: #64748b;
  --text-muted: #94a3b8;
  --text-nav: rgba(255,255,255,0.75);
  --text-nav-active: #ffffff;
  --shadow: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.08), 0 4px 6px rgba(0,0,0,0.04);
  --nav-width: 230px;
  --topbar-h: 56px;
  --radius: 10px;
  --radius-sm: 6px;
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Noto Sans KR', sans-serif;
  background: var(--bg);
  color: var(--text-primary);
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€ SIDEBAR â”€â”€ */
.sidebar {
  width: var(--nav-width);
  background: var(--bg-nav);
  position: fixed;
  top: 0; left: 0; bottom: 0;
  z-index: 200;
  display: flex;
  flex-direction: column;
  transition: transform 0.3s cubic-bezier(0.4,0,0.2,1), width 0.3s ease;
  overflow: hidden;
}

.sidebar.collapsed {
  width: 0;
  transform: translateX(-100%);
}

.sidebar-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  z-index: 150;
}

.sidebar-overlay.show { display: block; }

.sidebar-header {
  padding: 20px 18px 16px;
  border-bottom: 1px solid var(--border-nav);
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-height: 76px;
}

.logo-badge {
  background: linear-gradient(135deg, #1d6ff3, #0a4fc4);
  color: white;
  font-weight: 900;
  font-size: 11px;
  letter-spacing: 1px;
  padding: 4px 8px;
  border-radius: 4px;
  display: inline-block;
  margin-bottom: 5px;
}

.sidebar-period {
  font-size: 11px;
  color: var(--accent2);
  font-weight: 600;
  white-space: nowrap;
}

.sidebar-close {
  background: none;
  border: none;
  color: var(--text-nav);
  cursor: pointer;
  font-size: 20px;
  padding: 4px;
  line-height: 1;
  flex-shrink: 0;
}

.nav-scroll {
  flex: 1;
  overflow-y: auto;
  padding: 8px 0;
}

.nav-section-title {
  font-size: 9px;
  color: rgba(255,255,255,0.35);
  letter-spacing: 1.5px;
  text-transform: uppercase;
  padding: 10px 18px 4px;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 18px;
  cursor: pointer;
  border-left: 3px solid transparent;
  color: var(--text-nav);
  font-size: 13px;
  transition: all 0.15s;
  white-space: nowrap;
  user-select: none;
}

.nav-item:hover { background: var(--bg-nav-hover); color: var(--text-nav-active); }
.nav-item.active {
  background: rgba(26,86,219,0.25);
  color: var(--text-nav-active);
  border-left-color: #60a5fa;
  font-weight: 600;
}

.nav-icon { font-size: 15px; min-width: 20px; text-align: center; }
.nav-num {
  margin-left: auto;
  font-size: 9px;
  color: rgba(255,255,255,0.3);
  font-family: 'JetBrains Mono';
}

/* â”€â”€ MAIN â”€â”€ */
.main {
  margin-left: var(--nav-width);
  transition: margin-left 0.3s ease;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.main.full { margin-left: 0; }

/* â”€â”€ TOPBAR â”€â”€ */
.topbar {
  background: var(--bg-topbar);
  border-bottom: 1px solid var(--border);
  height: var(--topbar-h);
  display: flex;
  align-items: center;
  padding: 0 20px;
  gap: 12px;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--shadow);
}

.topbar-menu-btn {
  background: none;
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 7px 9px;
  cursor: pointer;
  font-size: 16px;
  line-height: 1;
  color: var(--text-secondary);
  transition: all 0.15s;
  flex-shrink: 0;
}

.topbar-menu-btn:hover { background: var(--bg); border-color: var(--accent); color: var(--accent); }

.topbar-info { flex: 1; min-width: 0; }
.topbar-title { font-size: 15px; font-weight: 700; color: var(--text-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.topbar-sub { font-size: 11px; color: var(--text-muted); }

.tab-group {
  display: flex;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  padding: 2px;
  gap: 1px;
  flex-shrink: 0;
}

.tab-btn {
  padding: 5px 14px;
  border: none;
  border-radius: 4px;
  background: transparent;
  color: var(--text-secondary);
  font-family: 'Noto Sans KR', sans-serif;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
}

.tab-btn.active {
  background: var(--accent);
  color: white;
  box-shadow: 0 1px 3px rgba(26,86,219,0.3);
}

/* â”€â”€ PAGES â”€â”€ */
.pages { flex: 1; }
.page { display: none; padding: 20px; animation: fadeIn 0.25s ease; }
.page.active { display: block; }

@keyframes fadeIn { from { opacity:0; transform:translateY(4px); } to { opacity:1; transform:none; } }

/* â”€â”€ CARDS â”€â”€ */
.card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 18px;
  box-shadow: var(--shadow);
  margin-bottom: 16px;
}

.card-title {
  font-size: 13px;
  font-weight: 700;
  color: var(--text-secondary);
  margin-bottom: 14px;
  display: flex;
  align-items: center;
  gap: 7px;
}

.card-title::before {
  content: '';
  width: 3px; height: 14px;
  background: var(--accent);
  border-radius: 2px;
  flex-shrink: 0;
}

/* KPI cards */
.kpi-grid {
  display: grid;
  gap: 12px;
  margin-bottom: 16px;
}

.kpi-3 { grid-template-columns: repeat(3, 1fr); }
.kpi-2 { grid-template-columns: repeat(2, 1fr); }
.kpi-4 { grid-template-columns: repeat(4, 1fr); }

.kpi-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  box-shadow: var(--shadow);
}

.kpi-label { font-size: 11px; color: var(--text-muted); margin-bottom: 6px; font-weight: 500; }
.kpi-value {
  font-size: 24px;
  font-weight: 900;
  letter-spacing: -0.5px;
  font-family: 'JetBrains Mono', monospace;
  line-height: 1;
  color: var(--text-primary);
}

.kpi-value.lg { font-size: 32px; }
.kpi-value.sm { font-size: 18px; }
.kpi-unit { font-size: 12px; color: var(--text-muted); font-family: 'Noto Sans KR'; font-weight: 400; margin-left: 3px; }

.kpi-badges { display: flex; gap: 5px; margin-top: 8px; flex-wrap: wrap; }

.badge {
  font-size: 10px;
  padding: 2px 7px;
  border-radius: 4px;
  font-weight: 600;
  font-family: 'JetBrains Mono';
  display: inline-block;
}

.b-up { background: #dcfce7; color: #16a34a; }
.b-dn { background: #fee2e2; color: #dc2626; }
.b-neu { background: #f1f5f9; color: var(--text-secondary); }
.b-gold { background: #fef3c7; color: #d97706; }
.b-blue { background: #dbeafe; color: #1d4ed8; }

/* Highlight card */
.highlight-card {
  background: linear-gradient(135deg, #1a3a7a 0%, #1d6ff3 100%);
  border: none;
  border-radius: var(--radius);
  padding: 20px;
  color: white;
  box-shadow: var(--shadow-md);
  margin-bottom: 16px;
  position: relative;
  overflow: hidden;
}

.highlight-card::after {
  content: '';
  position: absolute;
  right: -20px; top: -20px;
  width: 100px; height: 100px;
  background: rgba(255,255,255,0.05);
  border-radius: 50%;
}

.highlight-card .kpi-label { color: rgba(255,255,255,0.7); }
.highlight-card .kpi-unit { color: rgba(255,255,255,0.7); }

.hc-value {
  font-size: 36px;
  font-weight: 900;
  font-family: 'JetBrains Mono';
  letter-spacing: -1px;
  line-height: 1;
  color: white;
}

.hc-badge {
  display: inline-block;
  padding: 3px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  font-family: 'JetBrains Mono';
  background: rgba(255,255,255,0.15);
  color: white;
  margin-top: 8px;
  margin-right: 5px;
}

/* Gold highlight */
.highlight-card.gold {
  background: linear-gradient(135deg, #92400e 0%, #d97706 100%);
}

.highlight-card.teal {
  background: linear-gradient(135deg, #065f46 0%, #10b981 100%);
}

/* Tables */
.tbl-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }

table.dt {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
  min-width: 400px;
}

table.dt th {
  background: #f8fafc;
  color: var(--text-secondary);
  font-weight: 600;
  font-size: 11px;
  padding: 9px 12px;
  text-align: right;
  border-bottom: 2px solid var(--border);
  white-space: nowrap;
}

table.dt th:first-child { text-align: left; }
table.dt td { padding: 10px 12px; text-align: right; border-bottom: 1px solid #f1f5f9; font-family: 'JetBrains Mono'; font-size: 12px; }
table.dt td:first-child { text-align: left; font-family: 'Noto Sans KR'; font-size: 12px; font-weight: 500; }
table.dt tr:hover td { background: #f8fafc; }
table.dt tr.group td { background: #eff6ff; font-weight: 700; color: var(--accent-dark); }
table.dt tr.group td:first-child { color: var(--accent-dark); }

.txt-up { color: #16a34a; }
.txt-dn { color: #dc2626; }
.txt-gold { color: #d97706; }
.txt-blue { color: #1d4ed8; }
.txt-muted { color: var(--text-muted); }

/* Section label */
.sec-label {
  font-size: 10px;
  color: var(--text-muted);
  letter-spacing: 1.5px;
  text-transform: uppercase;
  margin: 20px 0 12px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
}
.sec-label::after { content:''; flex:1; height:1px; background:var(--border); }
.sec-label:first-child { margin-top: 0; }

/* Progress bar */
.prog-row { display:flex; align-items:center; gap:10px; margin-bottom:8px; }
.prog-lbl { font-size:12px; color:var(--text-secondary); min-width:70px; }
.prog-track { flex:1; height:7px; background:#f1f5f9; border-radius:4px; overflow:hidden; }
.prog-fill { height:100%; border-radius:4px; transition:width 0.8s ease; }
.prog-val { font-size:12px; font-family:'JetBrains Mono'; min-width:75px; text-align:right; color:var(--text-primary); font-weight:600; }

/* Filter row */
.filter-row {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  margin-bottom: 14px;
  align-items: center;
}

.f-btn {
  padding: 5px 12px;
  border-radius: 5px;
  border: 1px solid var(--border);
  background: var(--bg-card);
  color: var(--text-secondary);
  font-family: 'Noto Sans KR', sans-serif;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.15s;
  font-weight: 500;
}

.f-btn:hover, .f-btn.active {
  border-color: var(--accent);
  color: var(--accent);
  background: #eff6ff;
  font-weight: 600;
}

.search-inp {
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 5px;
  background: var(--bg-card);
  color: var(--text-primary);
  font-family: 'Noto Sans KR';
  font-size: 12px;
  outline: none;
  min-width: 160px;
}
.search-inp:focus { border-color: var(--accent); box-shadow: 0 0 0 2px rgba(26,86,219,0.1); }

/* Metric row */
.metric-row { display:flex; justify-content:space-between; align-items:center; padding:7px 0; border-bottom:1px solid #f1f5f9; font-size:13px; }
.metric-row:last-child { border-bottom:none; }
.metric-key { color:var(--text-secondary); }
.metric-val { font-family:'JetBrains Mono'; font-weight:600; }

/* Grid layouts */
.grid2 { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
.grid3 { display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px; }
.kpi-2 { display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:0; }

/* Chart container */
.chart-wrap { position: relative; }
.chart-wrap canvas { width: 100% !important; }

/* Status badge */
.status { display:inline-block; padding:2px 7px; border-radius:4px; font-size:10px; font-weight:700; }
.s-ok { background:#dcfce7; color:#16a34a; }
.s-warn { background:#fef3c7; color:#d97706; }
.s-bad { background:#fee2e2; color:#dc2626; }

/* Page subtitle */
.page-sub { font-size:12px; color:var(--text-muted); margin-bottom:16px; line-height:1.5; }

/* Divider */
.divider { height:1px; background:var(--border); margin:16px 0; }

/* Compact badge */
.cb { font-size:11px; padding:2px 6px; border-radius:3px; font-family:'JetBrains Mono'; display:inline-block; }
.cb-blue { background:#dbeafe; color:#1d4ed8; }
.cb-red { background:#fee2e2; color:#dc2626; }
.cb-green { background:#dcfce7; color:#16a34a; }
.cb-gray { background:#f1f5f9; color:var(--text-secondary); }

/* PF emphasis box */
.pf-box {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  border: 1px solid #f59e0b;
  border-radius: var(--radius);
  padding: 20px;
  margin-bottom: 16px;
}

/* Responsive adjustments */
@media (max-width: 640px) {
  .kpi-3 { grid-template-columns: 1fr 1fr; }
  .kpi-4 { grid-template-columns: 1fr 1fr; }
  .grid3 { grid-template-columns: 1fr 1fr; }
  .hc-value { font-size: 28px; }
  .kpi-value.lg { font-size: 26px; }
  .page { padding: 14px; }
  .topbar { padding: 0 12px; gap: 8px; }
}

@media (max-width: 400px) {
  .kpi-3 { grid-template-columns: 1fr 1fr; }
  .kpi-4 { grid-template-columns: 1fr 1fr; }
  .grid3 { grid-template-columns: 1fr; }
  .grid2 { grid-template-columns: 1fr; }
}

/* Scrollbar */
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

/* Chart legend */
.chart-legend { display:flex; gap:12px; flex-wrap:wrap; margin-top:8px; }
.legend-item { display:flex; align-items:center; gap:5px; font-size:11px; color:var(--text-secondary); }
.legend-dot { width:10px; height:10px; border-radius:2px; flex-shrink:0; }

/* Section spacer */
.spacer { height:8px; }
</style>
</head>
<body>

<!-- SIDEBAR OVERLAY -->
<div class="sidebar-overlay" id="overlay" onclick="closeSidebar()"></div>

<!-- SIDEBAR -->
<nav class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <div>
      <div class="logo-badge">HYUNDAI E&C</div>
      <div style="font-size:11px;color:rgba(255,255,255,0.6);margin-top:2px;">ê²½ì˜ì‹¤ì  ëŒ€ì‹œë³´ë“œ</div>
      <div class="sidebar-period">'26ë…„ 01ì›”ë§ ê¸°ì¤€</div>
    </div>
    <button class="sidebar-close" onclick="closeSidebar()">âœ•</button>
  </div>

  <div class="nav-scroll">
    <div class="nav-section-title">ì‹¤ì  í˜„í™©</div>
    <div class="nav-item active" onclick="showPage(0)"><span class="nav-icon">ğŸ“Š</span>ê²½ì˜ì‹¤ì _í†µí•©<span class="nav-num">P1</span></div>
    <div class="nav-item" onclick="showPage(1)"><span class="nav-icon">ğŸ¢</span>ê²½ì˜ì‹¤ì _ë³¸ë¶€<span class="nav-num">P2</span></div>
    <div class="nav-item" onclick="showPage(2)"><span class="nav-icon">ğŸ’§</span>ìœ ë™ì„±/ë¯¸ìˆ˜ì±„ê¶Œ<span class="nav-num">P3</span></div>
    <div class="nav-item" onclick="showPage(3)"><span class="nav-icon">ğŸ¦</span>PFí˜„í™©<span class="nav-num">P4</span></div>
    <div class="nav-item" onclick="showPage(4)"><span class="nav-icon">ğŸ“‰</span>ì›ê°€ìœ¨ ì¦ê°<span class="nav-num">P5</span></div>
    <div class="nav-item" onclick="showPage(5)"><span class="nav-icon">ğŸ—ï¸</span>ì£¼ìš”í˜„ì¥í˜„í™©<span class="nav-num">P6</span></div>
    <div class="nav-item" onclick="showPage(6)"><span class="nav-icon">ğŸ“ˆ</span>ì—°ê²°ì‹¤ì <span class="nav-num">P7</span></div>
    <div class="nav-item" onclick="showPage(7)"><span class="nav-icon">ğŸ—‚ï¸</span>ì¬ë¬´ì œí‘œ<span class="nav-num">P8</span></div>
    <div class="nav-item" onclick="showPage(8)"><span class="nav-icon">ğŸ†</span>ê²½ìŸì‚¬ ë¹„êµ<span class="nav-num">P9</span></div>

    <div class="nav-section-title" style="margin-top:12px;">ì„¤ì •</div>
    <div style="padding:10px 18px;">
      <div style="font-size:11px;color:rgba(255,255,255,0.4);line-height:1.5;">ë‹¨ìœ„: ì–µì›<br>ê¸°ì¤€ì¼: '26.01.31</div>
    </div>
  </div>
</nav>

<!-- MAIN -->
<div class="main" id="main">

  <!-- TOPBAR -->
  <div class="topbar">
    <button class="topbar-menu-btn" onclick="toggleSidebar()">â˜°</button>
    <div class="topbar-info">
      <div class="topbar-title" id="topbar-title">ê²½ì˜ì‹¤ì  í†µí•©</div>
      <div class="topbar-sub">'26ë…„ 01ì›”ë§ | ë‹¨ìœ„: ì–µì›</div>
    </div>
    <div class="tab-group" id="tab-group">
      <button class="tab-btn active" onclick="setTab('cum')">ëˆ„ê³„</button>
      <button class="tab-btn" onclick="setTab('month')">ë‹¹ì›”</button>
    </div>
  </div>

  <div class="pages">

  <!-- â•â•â•â•â•â•â•â•â•â• PAGE 1: ê²½ì˜ì‹¤ì _í†µí•© â•â•â•â•â•â•â•â•â•â• -->
  <div class="page active" id="page-0">

    <!-- ì»¤ìŠ¤í…€ íˆ´íŒ -->
    <div id="custom-tooltip" style="display:none;position:fixed;z-index:9999;background:rgba(15,23,42,0.97);color:#f8fafc;border-radius:10px;padding:14px 16px;font-size:12px;box-shadow:0 8px 32px rgba(0,0,0,0.25);min-width:260px;max-width:340px;pointer-events:none;border:1px solid rgba(255,255,255,0.1);"></div>

    <!-- ëˆ„ê³„ -->
    <div id="p1-cum">
      <p class="page-sub">ê³„ì—´ì‚¬ í†µí•© ë° íšŒì‚¬ë³„ ìˆ˜ì£¼Â·ë§¤ì¶œÂ·ì†ìµ(ê²½ìƒì´ìµ) í˜„í™© â€” '26ë…„ 01ì›”ë§ ëˆ„ê³„</p>

      <div class="kpi-grid kpi-3">
        <div class="kpi-card tt-trigger" data-tt="p1-order-kpi">
          <div class="kpi-label">ìˆ˜ì£¼ (ëˆ„ê³„)</div>
          <div class="kpi-value sm">19,941<span class="kpi-unit">ì–µ</span></div>
          <div class="kpi-badges">
            <span class="badge b-up">ê³„íšë¹„ 192%</span>
            <span class="badge b-dn">ì „ë…„ë¹„ â–³55.8%</span>
          </div>
        </div>
        <div class="kpi-card tt-trigger" data-tt="p1-sales-kpi">
          <div class="kpi-label">ë§¤ì¶œ (ëˆ„ê³„)</div>
          <div class="kpi-value sm">17,533<span class="kpi-unit">ì–µ</span></div>
          <div class="kpi-badges">
            <span class="badge b-neu">ê³„íšë¹„ 98.5%</span>
            <span class="badge b-dn">ì „ë…„ë¹„ â–³2.2%</span>
          </div>
        </div>
        <div class="kpi-card tt-trigger" data-tt="p1-profit-kpi">
          <div class="kpi-label">ê²½ìƒì†ìµ (ëˆ„ê³„)</div>
          <div class="kpi-value sm" style="color:var(--accent2)">825<span class="kpi-unit">ì–µ</span><span style="font-size:13px;color:#d97706;font-family:'Noto Sans KR';font-weight:500;margin-left:6px;">(4.2%)</span></div>
          <div class="kpi-badges">
            <span class="badge b-gold">ê³„íšë¹„ 88.5%</span>
            <span class="badge b-dn">ì „ë…„ë¹„ â–³12.3%</span>
          </div>
        </div>
      </div>

      <div class="sec-label">íšŒì‚¬ë³„ ì‹¤ì  ë¹„êµ</div>
      <div class="card">
        <div class="tbl-wrap">
          <table class="dt">
            <thead>
              <tr>
                <th>êµ¬ë¶„</th>
                <th>ìˆ˜ì£¼</th><th>ê³„íšë¹„</th><th>ì „ë…„ë¹„</th>
                <th>ë§¤ì¶œ</th><th>ê³„íšë¹„</th><th>ì „ë…„ë¹„</th>
                <th>ê²½ìƒì†ìµ</th><th>ê³„íšë¹„</th><th>ì „ë…„ë¹„</th><th style="font-size:10px;">ì†ìµë¥ </th>
                <th>í•´ì™¸ìˆ˜ì£¼</th>
              </tr>
            </thead>
            <tbody>
              <tr class="group tt-trigger" data-tt="p1-row-total">
                <td>ê³„ì—´ í†µí•©</td>
                <td>19,941</td><td class="txt-up">192.1%</td><td class="txt-dn">â–³55.8%</td>
                <td>19,941</td><td class="txt-neu">â€”</td><td class="txt-dn">â–³2.2%</td>
                <td class="txt-gold">825</td><td class="txt-gold">88.5%</td><td class="txt-dn">â–³12.3%</td><td class="txt-gold" style="font-size:11px;">4.2%</td>
                <td>1,037</td>
              </tr>
              <tr class="tt-trigger" data-tt="p1-row-hec">
                <td>í˜„ëŒ€ê±´ì„¤</td>
                <td>17,450</td><td class="txt-up">185.3%</td><td class="txt-dn">â–³52.1%</td>
                <td>17,450</td><td>98.5%</td><td class="txt-dn">â–³1.8%</td>
                <td class="txt-gold">712</td><td class="txt-gold">86.1%</td><td class="txt-dn">â–³14.1%</td><td class="txt-gold" style="font-size:11px;">4.1%</td>
                <td>987</td>
              </tr>
              <tr class="tt-trigger" data-tt="p1-row-hei">
                <td>í˜„ëŒ€ì—”ì§€ë‹ˆì–´ë§</td>
                <td>2,491</td><td class="txt-up">210.5%</td><td class="txt-dn">â–³63.2%</td>
                <td>2,491</td><td>103.2%</td><td class="txt-up">+3.5%</td>
                <td class="txt-gold">113</td><td class="txt-gold">96.6%</td><td class="txt-up">+8.7%</td><td class="txt-gold" style="font-size:11px;">4.5%</td>
                <td>50</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <div class="card-title">ìˆ˜ì£¼ ì¶”ì´ (ì›”ë³„)</div>
          <div class="chart-wrap" style="height:200px">
            <canvas id="p1-order-chart"></canvas>
          </div>
        </div>
        <div class="card">
          <div class="card-title">ë§¤ì¶œ ì¶”ì´ (ì›”ë³„)</div>
          <div class="chart-wrap" style="height:200px">
            <canvas id="p1-sales-chart"></canvas>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">ê²½ìƒì†ìµ(ì†ìµë¥ ) ì¶”ì´ (ì›”ë³„) â€” ë§‰ëŒ€: ê²½ìƒì†ìµ(ì–µì›) / ì„ : ì†ìµë¥ (%)</div>
        <div class="chart-wrap" style="height:220px">
          <canvas id="p1-profit-chart"></canvas>
        </div>
        <div class="chart-legend" style="margin-top:8px;">
          <div class="legend-item"><span class="legend-dot" style="background:#1a56db"></span>ê²½ìƒì†ìµ(ì–µì›)</div>
          <div class="legend-item"><span class="legend-dot" style="background:#f59e0b;border-radius:50%"></span>ì†ìµë¥ (%)</div>
        </div>
      </div>
    </div>

    <!-- ë‹¹ì›” -->
    <div id="p1-month" style="display:none">
      <p class="page-sub">ê³„ì—´ì‚¬ í†µí•© ë° íšŒì‚¬ë³„ ìˆ˜ì£¼Â·ë§¤ì¶œÂ·ì†ìµ(ê²½ìƒì´ìµ) í˜„í™© â€” '26ë…„ 01ì›” ë‹¹ì›”</p>
      <div class="kpi-grid kpi-3">
        <div class="kpi-card">
          <div class="kpi-label">ìˆ˜ì£¼ (ë‹¹ì›”)</div>
          <div class="kpi-value sm">19,941<span class="kpi-unit">ì–µ</span></div>
          <div class="kpi-badges"><span class="badge b-up">ì „ì›”ë¹„ +2,103</span></div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">ë§¤ì¶œ (ë‹¹ì›”)</div>
          <div class="kpi-value sm">17,533<span class="kpi-unit">ì–µ</span></div>
          <div class="kpi-badges"><span class="badge b-up">ì „ì›”ë¹„ +540</span><span class="badge b-dn">ì „ë…„ë¹„ â–³1.8%</span></div>
        </div>
        <div class="kpi-card">
          <div class="kpi-label">ê²½ìƒì†ìµ (ë‹¹ì›”)</div>
          <div class="kpi-value sm" style="color:var(--accent2)">825<span class="kpi-unit">ì–µ</span><span style="font-size:13px;color:#d97706;font-family:'Noto Sans KR';font-weight:500;margin-left:6px;">(4.2%)</span></div>
          <div class="kpi-badges"><span class="badge b-dn">ì „ë…„ë¹„ â–³12.3%</span></div>
        </div>
      </div>
      <div class="card">
        <div class="tbl-wrap">
          <table class="dt">
            <thead>
              <tr><th>êµ¬ë¶„</th><th>ìˆ˜ì£¼(ë‹¹ì›”)</th><th>ì „ì›”ë¹„</th><th>ë§¤ì¶œ(ë‹¹ì›”)</th><th>ì „ì›”ë¹„</th><th>ì „ë…„ë¹„</th><th>ê²½ìƒì†ìµ</th><th>ì „ë…„ë¹„</th><th>ì†ìµë¥ </th></tr>
            </thead>
            <tbody>
              <tr class="group"><td>ê³„ì—´ í†µí•©</td><td>19,941</td><td class="txt-up">+2,103</td><td>17,533</td><td class="txt-up">+540</td><td class="txt-dn">â–³2.2%</td><td class="txt-gold">825</td><td class="txt-dn">â–³12.3%</td><td class="txt-gold">4.2%</td></tr>
              <tr><td>í˜„ëŒ€ê±´ì„¤</td><td>17,450</td><td class="txt-up">+1,820</td><td>15,332</td><td class="txt-up">+480</td><td class="txt-dn">â–³1.8%</td><td class="txt-gold">712</td><td class="txt-dn">â–³14.1%</td><td class="txt-gold">4.1%</td></tr>
              <tr><td>í˜„ëŒ€ì—”ì§€ë‹ˆì–´ë§</td><td>2,491</td><td class="txt-up">+283</td><td>2,201</td><td class="txt-up">+60</td><td class="txt-up">+3.5%</td><td class="txt-gold">113</td><td class="txt-up">+8.7%</td><td class="txt-gold">4.5%</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• PAGE 2: ê²½ì˜ì‹¤ì _ë³¸ë¶€ â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-1">
    <div id="p2-cum">
      <p class="page-sub">í˜„ëŒ€ê±´ì„¤ ë³¸ë¶€ë³„ ìˆ˜ì£¼Â·ë§¤ì¶œÂ·ì†ìµÂ·ë¯¸ìˆ˜ì±„ê¶Œ í˜„í™© â€” '26ë…„ 01ì›”ë§ ëˆ„ê³„ (ë‹¨ìœ„: ì–µì›)</p>
      <div class="card">
        <div class="tbl-wrap">
          <table class="dt" style="min-width:640px;">
            <thead>
              <tr>
                <th>ë³¸ë¶€</th>
                <th style="color:#1a56db;font-weight:800;">ìˆ˜ì£¼</th><th>ê³„íšë¹„</th>
                <th style="color:#1a56db;font-weight:800;">ë§¤ì¶œ</th><th>ê³„íšë¹„</th>
                <th style="color:#d97706;font-weight:800;">ì†ìµ</th>
                <th style="color:#d97706;font-weight:800;">ì†ìµë¥ </th>
                <th style="color:#7c3aed;font-weight:800;">ë¯¸ìˆ˜ì±„ê¶Œ</th><th>ì „ì›”ë¹„</th>
              </tr>
            </thead>
            <tbody>
              <tr class="group"><td>í•©ê³„</td>
                <td class="txt-blue" style="font-weight:900;">14,619</td><td class="txt-up">127.5%</td>
                <td class="txt-blue" style="font-weight:900;">11,533</td><td>98.9%</td>
                <td class="txt-gold" style="font-weight:900;">270</td>
                <td class="txt-gold" style="font-weight:900;">2.3%</td>
                <td style="font-weight:900;color:#7c3aed;">82,036</td><td class="txt-up">+8,461</td>
              </tr>
              <tr class="tt-trigger" data-tt="p2-order-í† ëª©">
                <td>í† ëª©</td><td>201</td><td class="txt-muted">â€”</td>
                <td>1,595</td><td>98.9%</td>
                <td class="txt-up">92</td><td class="txt-up">5.8%</td><td>15,322</td><td class="txt-dn">â–³2,089</td>
              </tr>
              <tr class="tt-trigger" data-tt="p2-order-ê±´ì¶•">
                <td>ê±´ì¶•</td><td>5,490</td><td class="txt-muted">â€”</td>
                <td>1,509</td><td>103.1%</td>
                <td class="txt-dn">â–³301</td><td class="txt-dn">â€”</td><td>7,728</td><td class="txt-up">+2,141</td>
              </tr>
              <tr class="tt-trigger" data-tt="p2-order-ì£¼íƒ">
                <td>ì£¼íƒ</td><td>6,854</td><td class="txt-up">118.3%</td>
                <td>4,745</td><td>118.3%</td>
                <td class="txt-up">253</td><td class="txt-up">5.3%</td><td>41,359</td><td class="txt-up">+3,189</td>
              </tr>
              <tr class="tt-trigger" data-tt="p2-order-í”ŒëœíŠ¸">
                <td>í”ŒëœíŠ¸</td><td>35</td><td class="txt-muted">â€”</td>
                <td>2,970</td><td>92.3%</td>
                <td class="txt-up">172</td><td class="txt-up">5.8%</td><td>12,660</td><td class="txt-up">+4,545</td>
              </tr>
              <tr class="tt-trigger" data-tt="p2-order-ë‰´ì—ë„ˆì§€">
                <td>ë‰´ì—ë„ˆì§€</td><td>39</td><td class="txt-muted">â€”</td>
                <td>714</td><td>92.3%</td>
                <td class="txt-up">54</td><td class="txt-up">7.6%</td><td>5,967</td><td class="txt-up">+675</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Trend chart section -->
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;flex-wrap:wrap;gap:8px;">
          <div class="card-title" style="margin-bottom:0;">ë³¸ë¶€ë³„ í•­ëª© ì¶”ì´ (10ë…„)</div>
        </div>
        <div class="filter-row" style="margin-bottom:10px;">
          <span style="font-size:11px;color:var(--text-muted);margin-right:4px;">í•­ëª©:</span>
          <button class="f-btn active" onclick="setDeptTrend('ìˆ˜ì£¼',this)">ìˆ˜ì£¼</button>
          <button class="f-btn" onclick="setDeptTrend('ë§¤ì¶œ',this)">ë§¤ì¶œ</button>
          <button class="f-btn" onclick="setDeptTrend('ì†ìµ',this)">ì†ìµ</button>
          <button class="f-btn" onclick="setDeptTrend('ë¯¸ìˆ˜ì±„ê¶Œ',this)">ë¯¸ìˆ˜ì±„ê¶Œ</button>
          <span style="width:1px;height:20px;background:var(--border);margin:0 4px;"></span>
          <span style="font-size:11px;color:var(--text-muted);margin-right:4px;">ë³¸ë¶€:</span>
          <button class="f-btn active" onclick="setDeptFilter('ì „ì²´',this)" id="dept-f-all">ì „ì²´</button>
          <button class="f-btn" onclick="setDeptFilter('í† ëª©',this)">í† ëª©</button>
          <button class="f-btn" onclick="setDeptFilter('ê±´ì¶•',this)">ê±´ì¶•</button>
          <button class="f-btn" onclick="setDeptFilter('ì£¼íƒ',this)">ì£¼íƒ</button>
          <button class="f-btn" onclick="setDeptFilter('í”ŒëœíŠ¸',this)">í”ŒëœíŠ¸</button>
          <button class="f-btn" onclick="setDeptFilter('ë‰´ì—ë„ˆì§€',this)">ë‰´ì—ë„ˆì§€</button>
        </div>
        <div id="dept-trend-label" style="font-size:11px;color:var(--text-muted);margin-bottom:8px;">ìˆ˜ì£¼ ê¸°ì¤€ (2016~2026) â€” ì „ì²´ ë³¸ë¶€</div>
        <div class="chart-wrap" style="height:220px">
          <canvas id="dept-trend-chart"></canvas>
        </div>
        <div class="chart-legend" style="margin-top:10px;">
          <div class="legend-item"><span class="legend-dot" style="background:#3b82f6"></span>í† ëª©</div>
          <div class="legend-item"><span class="legend-dot" style="background:#f59e0b"></span>ì£¼íƒ</div>
          <div class="legend-item"><span class="legend-dot" style="background:#8b5cf6"></span>ê±´ì¶•</div>
          <div class="legend-item"><span class="legend-dot" style="background:#ef4444"></span>í”ŒëœíŠ¸</div>
          <div class="legend-item"><span class="legend-dot" style="background:#10b981"></span>ë‰´ì—ë„ˆì§€</div>
        </div>
      </div>
    </div>

    <div id="p2-month" style="display:none">
      <p class="page-sub">í˜„ëŒ€ê±´ì„¤ ë³¸ë¶€ë³„ ìˆ˜ì£¼Â·ë§¤ì¶œÂ·ì†ìµÂ·ë¯¸ìˆ˜ì±„ê¶Œ í˜„í™© â€” '26ë…„ 01ì›” ë‹¹ì›”</p>
      <div class="card">
        <div class="tbl-wrap">
          <table class="dt">
            <thead>
              <tr>
                <th>ë³¸ë¶€</th>
                <th style="color:#1a56db;font-weight:800;">ìˆ˜ì£¼(ë‹¹ì›”)</th><th>ì „ì›”ë¹„</th>
                <th style="color:#1a56db;font-weight:800;">ë§¤ì¶œ(ë‹¹ì›”)</th><th>ì „ì›”ë¹„</th>
                <th style="color:#d97706;font-weight:800;">ì†ìµ(ë‹¹ì›”)</th>
                <th style="color:#7c3aed;font-weight:800;">ë¯¸ìˆ˜ì±„ê¶Œ</th><th>ì „ì›”ë¹„</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>í† ëª©</td><td>45</td><td class="txt-up">+12</td><td>1,595</td><td class="txt-up">+210</td><td class="txt-up">92</td><td>15,322</td><td class="txt-dn">â–³2,089</td></tr>
              <tr><td>ê±´ì¶•</td><td>1,820</td><td class="txt-up">+350</td><td>1,509</td><td class="txt-dn">â–³105</td><td class="txt-dn">â–³301</td><td>7,728</td><td class="txt-up">+2,141</td></tr>
              <tr><td>ì£¼íƒ</td><td>6,854</td><td class="txt-up">+2,310</td><td>4,745</td><td class="txt-up">+480</td><td class="txt-up">253</td><td>41,359</td><td class="txt-up">+3,189</td></tr>
              <tr><td>í”ŒëœíŠ¸</td><td>35</td><td class="txt-dn">â–³20</td><td>2,970</td><td class="txt-up">+95</td><td class="txt-up">172</td><td>12,660</td><td class="txt-up">+4,545</td></tr>
              <tr><td>ë‰´ì—ë„ˆì§€</td><td>39</td><td class="txt-up">+5</td><td>714</td><td class="txt-up">+30</td><td class="txt-up">54</td><td>5,967</td><td class="txt-up">+675</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• PAGE 3: ìœ ë™ì„±/ë¯¸ìˆ˜ì±„ê¶Œ â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-2">
    <p class="page-sub">í˜„ëŒ€ê±´ì„¤ í˜„ê¸ˆìœ ë™ì„±(Net Cash + ì°¨ì…ê¸ˆ) Â· ë¯¸ìˆ˜ì±„ê¶Œ Â· ë¯¸ì²­êµ¬ì±„ê¶Œ í˜„í™©</p>

    <!-- CASH HIGHLIGHT -->
    <div class="highlight-card tt-trigger" data-tt="p3-cash">
      <div class="kpi-label" style="font-size:13px;font-weight:700;">í˜„ê¸ˆìœ ë™ì„± (Net Cash + ì°¨ì…ê¸ˆ)</div>
      <div class="hc-value">41,054<span style="font-size:16px;font-weight:400;color:rgba(255,255,255,0.7);margin-left:5px;">ì–µì›</span></div>
      <div style="margin-top:8px;">
        <span class="hc-badge">ì „ì›”ë¹„ â–³5,223</span>
        <span class="hc-badge">ì „ë…„ë§ë¹„ â–³5,223</span>
      </div>
    </div>

    <div class="kpi-grid kpi-2" style="margin-bottom:16px;">
      <div class="kpi-card tt-trigger" data-tt="p3-netcash">
        <div class="kpi-label">Net-Cash</div>
        <div class="kpi-value sm">798<span class="kpi-unit">ì–µì›</span></div>
        <div class="kpi-badges">
          <span class="badge b-dn">ì „ì›”ë¹„ â–³7,780</span>
          <span class="badge b-dn">ì „ë…„ë§ë¹„ â–³8,210</span>
        </div>
      </div>
      <div class="kpi-card tt-trigger" data-tt="p3-debt">
        <div class="kpi-label">ì°¨ì…ê¸ˆ</div>
        <div class="kpi-value sm">40,256<span class="kpi-unit">ì–µì›</span></div>
        <div class="kpi-badges">
          <span class="badge b-up">ì „ì›”ë¹„ +2,557</span>
          <span class="badge b-up">ì „ë…„ë§ë¹„ +2,987</span>
        </div>
      </div>
    </div>

    <!-- ë¯¸ìˆ˜ì±„ê¶Œ HIGHLIGHT (gold) -->
    <div class="highlight-card gold" style="margin-bottom:16px;">
      <div class="kpi-label" style="font-size:13px;font-weight:700;color:rgba(255,255,255,0.8);">ë¯¸ìˆ˜ì±„ê¶Œ (í˜„ëŒ€ê±´ì„¤)</div>
      <div class="hc-value tt-trigger" data-tt="p3-mis" style="cursor:pointer;">83,036<span style="font-size:16px;font-weight:400;color:rgba(255,255,255,0.7);margin-left:5px;">ì–µì›</span></div>
      <div style="margin-top:8px;">
        <span class="hc-badge">ì „ì›”ë¹„ +8,461</span>
        <span class="hc-badge">ì „ë…„ë§ë¹„ +15,000</span>
      </div>
      <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap;">
        <div style="text-align:center;">
          <div style="font-size:11px;color:rgba(255,255,255,0.65);">êµ­ë‚´</div>
          <div style="font-size:18px;font-weight:900;font-family:'JetBrains Mono';">46,500</div>
          <div style="font-size:10px;color:rgba(255,255,255,0.6);">ì–µ (56%)</div>
        </div>
        <div style="width:1px;background:rgba(255,255,255,0.2);"></div>
        <div style="text-align:center;">
          <div style="font-size:11px;color:rgba(255,255,255,0.65);">í•´ì™¸</div>
          <div style="font-size:18px;font-weight:900;font-family:'JetBrains Mono';">36,536</div>
          <div style="font-size:10px;color:rgba(255,255,255,0.6);">ì–µ (44%)</div>
        </div>
      </div>
    </div>

    <!-- ë¯¸ì²­êµ¬ì±„ê¶Œ HIGHLIGHT (teal) -->
    <div class="highlight-card teal" style="margin-bottom:16px;">
      <div class="kpi-label" style="font-size:13px;font-weight:700;color:rgba(255,255,255,0.8);">ë¯¸ì²­êµ¬ì±„ê¶Œ (í˜„ëŒ€ê±´ì„¤)</div>
      <div class="hc-value tt-trigger" data-tt="p3-micheong" style="cursor:pointer;">42,000<span style="font-size:16px;font-weight:400;color:rgba(255,255,255,0.7);margin-left:5px;">ì–µì›</span></div>
      <div style="margin-top:8px;">
        <span class="hc-badge">ì „ì›”ë¹„ â–³2,100</span>
        <span class="hc-badge">ì „ë…„ë§ë¹„ â–³7,476</span>
      </div>
      <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap;">
        <div style="text-align:center;">
          <div style="font-size:11px;color:rgba(255,255,255,0.65);">êµ­ë‚´</div>
          <div style="font-size:18px;font-weight:900;font-family:'JetBrains Mono';">28,400</div>
          <div style="font-size:10px;color:rgba(255,255,255,0.6);">ì–µ (68%)</div>
        </div>
        <div style="width:1px;background:rgba(255,255,255,0.2);"></div>
        <div style="text-align:center;">
          <div style="font-size:11px;color:rgba(255,255,255,0.65);">í•´ì™¸</div>
          <div style="font-size:18px;font-weight:900;font-family:'JetBrains Mono';">13,600</div>
          <div style="font-size:10px;color:rgba(255,255,255,0.6);">ì–µ (32%)</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ë¯¸ìˆ˜ì±„ê¶Œ ì—°ë„ë³„ ì¶”ì´ (í˜„ëŒ€ê±´ì„¤, ì–µì›)</div>
      <div class="chart-wrap" style="height:180px">
        <canvas id="mis-trend-chart"></canvas>
      </div>
    </div>

    <div class="card">
      <div class="card-title">í˜„ê¸ˆìœ ë™ì„± ì—°ë„ë³„ ì¶”ì´ (ì–µì›)</div>
      <div class="chart-wrap" style="height:160px">
        <canvas id="cash-trend-chart"></canvas>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• PAGE 4: PFí˜„í™© â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-3">
    <p class="page-sub">í˜„ëŒ€ê±´ì„¤ ìš°ë°œë¶€ì±„(ì§€ê¸‰ë³´ì¦Â·ì±…ì„ì¤€ê³µ) ë° ëŒ€ì—¬ê¸ˆ í˜„í™© â€” ì‹¤ì œ ë°ì´í„° ë°˜ì˜</p>

    <!-- ìš°ë°œë¶€ì±„ HIGHLIGHT -->
    <div class="pf-box">
      <div style="font-size:12px;font-weight:700;color:#92400e;margin-bottom:10px;">âš  ìš°ë°œë¶€ì±„ (ì´ê³„)</div>
      <div style="font-size:36px;font-weight:900;font-family:'JetBrains Mono';letter-spacing:-1px;color:#92400e;" id="pf-total-val">233,491</div>
      <div style="font-size:12px;color:#a16207;margin-top:2px;">ì–µì›</div>
      <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;">
        <span class="badge b-dn" id="pf-vs-prev">ì „ì›”ë¹„ +1,790</span>
        <span class="badge b-dn" id="pf-vs-yr">ì „ë…„ë¹„ +13,268</span>
      </div>
      <!-- ë¸Œë¦¿ì§€ë¡  ê°•ì¡° -->
      <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;">
        <div style="background:rgba(239,68,68,0.15);border:1.5px solid #ef4444;border-radius:8px;padding:10px 16px;flex:1;min-width:120px;">
          <div style="font-size:10px;color:#dc2626;font-weight:700;letter-spacing:1px;text-transform:uppercase;">ë¸Œë¦¿ì§€ë¡  âš¡</div>
          <div style="font-size:22px;font-weight:900;font-family:'JetBrains Mono';color:#dc2626;margin-top:2px;">24,004<span style="font-size:12px;font-weight:400;color:#dc2626;">ì–µ</span></div>
        </div>
        <div style="background:rgba(59,130,246,0.1);border:1px solid #93c5fd;border-radius:8px;padding:10px 16px;flex:1;min-width:120px;">
          <div style="font-size:10px;color:#1d4ed8;font-weight:700;letter-spacing:1px;text-transform:uppercase;">ë³¸ PF</div>
          <div style="font-size:22px;font-weight:900;font-family:'JetBrains Mono';color:#1d4ed8;margin-top:2px;">209,487<span style="font-size:12px;font-weight:400;color:#1d4ed8;">ì–µ</span></div>
        </div>
      </div>
    </div>

    <!-- ì§€ê¸‰ë³´ì¦ / ì±…ì„ì¤€ê³µ -->
    <div class="grid2">
      <div class="card tt-trigger" data-tt="p4-jb">
        <div class="card-title">ì§€ê¸‰ë³´ì¦</div>
        <div style="font-size:24px;font-weight:900;font-family:'JetBrains Mono';color:var(--accent);" id="jb-val">131,443</div>
        <div style="font-size:11px;color:var(--text-muted);margin-bottom:10px;">ì–µì›</div>
        <div class="metric-row"><span class="metric-key">ì „ì›”ë¹„</span><span class="metric-val txt-up" id="jb-prev-diff">+4,046</span></div>
        <div class="metric-row"><span class="metric-key">ì „ë…„ë¹„</span><span class="metric-val txt-up" id="jb-yr-diff">+7,921</span></div>
        <div class="divider"></div>
        <div style="font-size:11px;color:var(--text-secondary);margin-bottom:6px;font-weight:600;">ì‚¬ì—…ìœ í˜•ë³„</div>
        <div class="metric-row"><span class="metric-key">ì‹œí–‰ì‚¬ì—…</span><span class="metric-val">50,876ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ë„ì‹œì •ë¹„</span><span class="metric-val">63,899ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">SOC</span><span class="metric-val">2,239ì–µ</span></div>
        <div class="divider"></div>
        <div style="font-size:11px;color:var(--text-secondary);margin-bottom:6px;font-weight:600;">ì‹ ìš©ë³´ê°•ìœ í˜•</div>
        <div class="metric-row"><span class="metric-key">ì—°ëŒ€ë³´ì¦</span><span class="metric-val">87,181ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ìê¸ˆë³´ì¶©</span><span class="metric-val">29,832ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">HUG</span><span class="metric-val txt-muted">14,429ì–µ</span></div>
      </div>

      <div class="card tt-trigger" data-tt="p4-cp">
        <div class="card-title">ì±…ì„ì¤€ê³µ</div>
        <div style="font-size:24px;font-weight:900;font-family:'JetBrains Mono';color:#7c3aed;" id="cp-val">102,048</div>
        <div style="font-size:11px;color:var(--text-muted);margin-bottom:10px;">ì–µì›</div>
        <div class="metric-row"><span class="metric-key">ì „ì›”ë¹„</span><span class="metric-val txt-dn" id="cp-prev-diff">â–³2,256</span></div>
        <div class="metric-row"><span class="metric-key">ì „ë…„ë¹„</span><span class="metric-val txt-up" id="cp-yr-diff">+5,347</span></div>
        <div class="divider"></div>
        <div style="font-size:11px;color:var(--text-secondary);margin-bottom:6px;font-weight:600;">ì‚¬ì—…ìœ í˜•ë³„</div>
        <div class="metric-row"><span class="metric-key">ì‹œí–‰ì‚¬ì—…</span><span class="metric-val">851ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ë„ì‹œì •ë¹„</span><span class="metric-val">14,429ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">SOC</span><span class="metric-val">86,768ì–µ</span></div>
        <div class="divider"></div>
        <div style="font-size:11px;color:var(--text-secondary);font-weight:600;">â€» HUG í¬í•¨ í•©ì‚°</div>
        <div style="font-size:20px;font-weight:900;font-family:'JetBrains Mono';color:#7c3aed;margin-top:4px;">116,477ì–µ</div>
      </div>
    </div>

    <!-- ì§€ì—­ë³„ ë¶„í¬ + ë„ë„› -->
    <div class="card">
      <div class="card-title">ì§€ì—­ë³„ ì§€ê¸‰ë³´ì¦ ë¶„í¬</div>
      <div class="grid2" style="align-items:center;">
        <div>
          <div class="prog-row"><span class="prog-lbl">ì„œìš¸</span><div class="prog-track"><div class="prog-fill" style="width:73%;background:#3b82f6;"></div></div><span class="prog-val txt-blue">9.7ì¡° (73%)</span></div>
          <div class="prog-row"><span class="prog-lbl">6ëŒ€ê´‘ì—­ì‹œ</span><div class="prog-track"><div class="prog-fill" style="width:10%;background:#f59e0b;"></div></div><span class="prog-val txt-gold">1.4ì¡° (10%)</span></div>
          <div class="prog-row"><span class="prog-lbl">ìˆ˜ë„ê¶Œ</span><div class="prog-track"><div class="prog-fill" style="width:9%;background:#8b5cf6;"></div></div><span class="prog-val" style="color:#7c3aed;">1.2ì¡° (9%)</span></div>
          <div class="prog-row"><span class="prog-lbl">ì§€ë°©</span><div class="prog-track"><div class="prog-fill" style="width:5%;background:#94a3b8;"></div></div><span class="prog-val txt-muted">0.7ì¡° (5%)</span></div>
          <div class="prog-row"><span class="prog-lbl">ê¸°íƒ€</span><div class="prog-track"><div class="prog-fill" style="width:1%;background:#cbd5e1;"></div></div><span class="prog-val txt-muted">0.1ì¡°</span></div>
        </div>
        <div class="chart-wrap" style="height:150px;">
          <canvas id="region-donut-chart"></canvas>
        </div>
      </div>
    </div>

    <!-- ìê¸°ìë³¸ ëŒ€ë¹„ ì§€ê¸‰ë³´ì¦ ë¹„ìœ¨ -->
    <div class="card">
      <div class="card-title">ìê¸°ìë³¸ ëŒ€ë¹„ ì§€ê¸‰ë³´ì¦ ë¹„ìœ¨ ì¶”ì´</div>
      <div class="chart-wrap" style="height:160px">
        <canvas id="equity-ratio-chart"></canvas>
      </div>
    </div>

    <!-- ë§Œê¸° ì›”ë³„ -->
    <div class="card">
      <div class="card-title">ì§€ê¸‰ë³´ì¦ ë§Œê¸° ì¼ì •ë³„ ê¸ˆì•¡ í•©ê³„ (ì–µì›)</div>
      <div class="chart-wrap" style="height:190px">
        <canvas id="expiry-chart"></canvas>
      </div>
    </div>

    <!-- ì±…ì„ì¤€ê³µ í˜„ì¥ ìƒì„¸ -->
    <div class="sec-label">ì±…ì„ì¤€ê³µ í˜„ì¥ ìƒì„¸</div>
    <div class="card">
      <div class="tbl-wrap">
        <table class="dt" style="min-width:500px;">
          <thead>
            <tr><th style="min-width:150px;">í˜„ì¥ëª…</th><th>ë§Œê¸°ì¼</th><th>ë³´ì¦ê¸ˆì•¡(ì–µ)</th><th>D-day</th></tr>
          </thead>
          <tbody id="cp-sites-tbody"></tbody>
        </table>
      </div>
    </div>

    <!-- PF ì›”ë³„ ì¶”ì´ -->
    <div class="card">
      <div class="card-title">ìš°ë°œë¶€ì±„ ì›”ë³„ ì¶”ì´ (ì§€ê¸‰ë³´ì¦ / ì±…ì„ì¤€ê³µ)</div>
      <div class="chart-wrap" style="height:190px">
        <canvas id="pf-trend-chart"></canvas>
      </div>
      <div class="chart-legend" style="margin-top:8px;">
        <div class="legend-item"><span class="legend-dot" style="background:#3b82f6"></span>ì§€ê¸‰ë³´ì¦</div>
        <div class="legend-item"><span class="legend-dot" style="background:#8b5cf6"></span>ì±…ì„ì¤€ê³µ</div>
      </div>
    </div>

    <!-- ëŒ€ì—¬ê¸ˆ -->
    <div class="sec-label">ëŒ€ì—¬ê¸ˆ</div>
    <div class="card">
      <div style="font-size:22px;font-weight:900;font-family:'JetBrains Mono';">12,546<span class="kpi-unit">ì–µì›</span></div>
      <div class="divider"></div>
      <div class="metric-row"><span class="metric-key">ì‹œí–‰ì‚¬ì—…</span><span class="metric-val txt-dn">7,998 (â–³104)</span></div>
      <div class="metric-row"><span class="metric-key">ë„ì‹œì •ë¹„</span><span class="metric-val txt-dn">4,548 (â–³140)</span></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• PAGE 5: ì›ê°€ìœ¨ ì¦ê° â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-4">
    <p class="page-sub">ì›ê°€ìœ¨ ë³€ë™ì— ë”°ë¥¸ ë³¸ë¶€ë³„ ì†ìµíš¨ê³¼ â€” '26ë…„ 01ì›”ë§ ëˆ„ê³„ (ë‹¨ìœ„: ì–µì›)</p>

    <div class="kpi-grid kpi-3">
      <div class="kpi-card">
        <div class="kpi-label">ê°œì„  í•©ê³„</div>
        <div class="kpi-value sm txt-up">+34<span class="kpi-unit">ì–µ</span></div>
      </div>
      <div class="kpi-card">
        <div class="kpi-label">ì•…í™” í•©ê³„</div>
        <div class="kpi-value sm txt-dn">â–³436<span class="kpi-unit">ì–µ</span></div>
      </div>
      <div class="kpi-card">
        <div class="kpi-label">ë‹¹ì›” ìˆœíš¨ê³¼</div>
        <div class="kpi-value sm txt-dn">â–³402<span class="kpi-unit">ì–µ</span></div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ë³¸ë¶€ë³„ ì›ê°€ìœ¨ ì¦ê° íš¨ê³¼</div>
      <div class="tbl-wrap">
        <table class="dt">
          <thead>
            <tr><th>ë³¸ë¶€</th><th>ê°œì„ (+)</th><th>ì•…í™”(â–³)</th><th>ë‹¹ì›” í•©ê³„</th><th>10ê°œë…„ ëˆ„ê³„</th></tr>
          </thead>
          <tbody>
            <tr class="group"><td>í•©ê³„</td><td class="txt-up">+34</td><td class="txt-dn">â–³436</td><td class="txt-dn">â–³402</td><td class="txt-dn">â–³28,969</td></tr>
            <tr><td>í† ëª©</td><td class="txt-up">+2</td><td class="txt-dn">â–³6</td><td class="txt-dn">â–³4</td><td class="txt-dn">â–³12,685</td></tr>
            <tr><td>ê±´ì¶•</td><td class="txt-up">+20</td><td class="txt-dn">â–³394</td><td class="txt-dn">â–³373</td><td class="txt-dn">â–³1,657</td></tr>
            <tr><td>ì£¼íƒ</td><td class="txt-up">+11</td><td class="txt-dn">â–³36</td><td class="txt-dn">â–³25</td><td class="txt-up">+4,981</td></tr>
            <tr><td>í”ŒëœíŠ¸</td><td class="txt-muted">â€”</td><td class="txt-muted">â€”</td><td class="txt-muted">â€”</td><td class="txt-dn">â–³18,828</td></tr>
            <tr><td>ë‰´ì—ë„ˆì§€</td><td class="txt-up">+1</td><td class="txt-muted">â€”</td><td class="txt-up">+1</td><td class="txt-dn">â–³780</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ì¶”ì´ ì°¨íŠ¸ + í•„í„° -->
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;flex-wrap:wrap;gap:8px;">
        <div class="card-title" style="margin-bottom:0;">ì—°ë„ë³„ ì›ê°€ìœ¨ ì¦ê° í•©ê³„ ì¶”ì´</div>
        <div class="filter-row" style="margin-bottom:0;">
          <button class="f-btn active" onclick="setCostFilter('ì „ì²´',this)">ì „ì²´</button>
          <button class="f-btn" onclick="setCostFilter('í† ëª©',this)">í† ëª©</button>
          <button class="f-btn" onclick="setCostFilter('ê±´ì¶•',this)">ê±´ì¶•</button>
          <button class="f-btn" onclick="setCostFilter('ì£¼íƒ',this)">ì£¼íƒ</button>
          <button class="f-btn" onclick="setCostFilter('í”ŒëœíŠ¸',this)">í”ŒëœíŠ¸</button>
          <button class="f-btn" onclick="setCostFilter('ë‰´ì—ë„ˆì§€',this)">ë‰´ì—ë„ˆì§€</button>
        </div>
      </div>
      <div class="chart-wrap" style="height:200px">
        <canvas id="cost-trend-chart"></canvas>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• PAGE 6: ì£¼ìš”í˜„ì¥í˜„í™© â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-5">
    <p class="page-sub">í˜„ì¥ë³„ ë§¤ì¶œÂ·ë§¤ì¶œì´ìµÂ·ì›ê°€ìœ¨Â·ë¯¸ìˆ˜Â·PFì”ì•¡ í˜„í™©</p>

    <!-- Filter -->
    <div class="card" style="padding:14px;">
      <div class="filter-row">
        <button class="f-btn active" onclick="filterSite('êµ­ë‚´ì™¸','all',this)">ì „ì²´</button>
        <button class="f-btn" onclick="filterSite('êµ­ë‚´ì™¸','êµ­ë‚´',this)">êµ­ë‚´</button>
        <button class="f-btn" onclick="filterSite('êµ­ë‚´ì™¸','í•´ì™¸',this)">í•´ì™¸</button>
        <span style="width:1px;height:20px;background:var(--border);"></span>
        <button class="f-btn active" onclick="filterSite('ë³¸ë¶€','all',this)">ì „ì²´</button>
        <button class="f-btn" onclick="filterSite('ë³¸ë¶€','í† ëª©',this)">í† ëª©</button>
        <button class="f-btn" onclick="filterSite('ë³¸ë¶€','ê±´ì¶•',this)">ê±´ì¶•</button>
        <button class="f-btn" onclick="filterSite('ë³¸ë¶€','ì£¼íƒ',this)">ì£¼íƒ</button>
        <button class="f-btn" onclick="filterSite('ë³¸ë¶€','í”ŒëœíŠ¸',this)">í”ŒëœíŠ¸</button>
        <button class="f-btn" onclick="filterSite('ë³¸ë¶€','ë‰´ì—ë„ˆì§€',this)">ë‰´ì—ë„ˆì§€</button>
      </div>
      <input class="search-inp" type="text" placeholder="ğŸ” í˜„ì¥ëª… ê²€ìƒ‰..." oninput="searchSite(this.value)" style="width:100%;">
    </div>

    <div class="card">
      <div class="tbl-wrap">
        <table class="dt" style="min-width:700px;" id="site-table">
          <thead>
            <tr>
              <th style="min-width:140px;">í˜„ì¥ëª…</th><th>ë³¸ë¶€</th><th>êµ­ë‚´ì™¸</th>
              <th>ê³„ì•½ê³ </th><th>ì§„í–‰ë¥ </th><th>ë§¤ì¶œ(ì‹¤ì )</th><th>ì›ê°€ìœ¨</th><th>ë¯¸ìˆ˜</th><th>PFìœ í˜•</th>
            </tr>
          </thead>
          <tbody id="site-tbody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• PAGE 7: ì—°ê²°ì‹¤ì  â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-6">
    <p class="page-sub">ë‹¹ë¶„ê¸°Â·ë¶„ê¸°ë§ ë³„ë„Â·ì—°ê²° ì¬ë¬´ì œí‘œìƒ ë§¤ì¶œÂ·ì˜ì—…ì´ìµÂ·ê²½ìƒì´ìµÂ·ë‹¹ê¸°ìˆœì´ìµ</p>

    <div style="display:flex;gap:8px;margin-bottom:16px;">
      <button class="tab-btn active" id="p7-sep-btn" style="border:1px solid var(--border);border-radius:var(--radius-sm);" onclick="setP7('ë³„ë„')">ë³„ë„</button>
      <button class="tab-btn" id="p7-con-btn" style="border:1px solid var(--border);border-radius:var(--radius-sm);" onclick="setP7('ì—°ê²°')">ì—°ê²°</button>
    </div>

    <div class="card">
      <div class="tbl-wrap">
        <table class="dt">
          <thead>
            <tr><th>êµ¬ë¶„</th><th>ë‹¹ë¶„ê¸°</th><th>ì „ë…„ ë™ê¸°</th><th>ëŒ€ë¹„</th><th>ë¶„ê¸°ë§[ëˆ„ê³„]</th><th>ì „ë…„ ë™ê¸°</th><th>ëŒ€ë¹„</th></tr>
          </thead>
          <tbody id="p7-tbody"></tbody>
        </table>
      </div>
    </div>

    <div class="grid2">
      <div class="card">
        <div class="card-title" id="p7-yoy-title">ì „ë…„ë™ê¸°ë¹„ â€” ë³„ë„ ê¸°ì¤€</div>
        <div class="metric-row"><span class="metric-key">ë§¤ì¶œ</span><span class="metric-val txt-dn">â–³2,176ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ì˜ì—…ì´ìµ</span><span class="metric-val txt-up">+4,667ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ì˜ì—…ì´ìµë¥ </span><span class="metric-val txt-up">+2.8%p</span></div>
        <div class="metric-row"><span class="metric-key">ê²½ìƒì´ìµ</span><span class="metric-val txt-up">+3,102ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ë‹¹ê¸°ìˆœì´ìµ</span><span class="metric-val txt-up">+2,890ì–µ</span></div>
      </div>
      <div class="card">
        <div class="card-title">ì˜ì—…ì´ìµë¥  ë¶„ê¸° ì¶”ì´</div>
        <div class="chart-wrap" style="height:140px">
          <canvas id="op-margin-chart"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• PAGE 8: ì¬ë¬´ì œí‘œ â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-7">
    <p class="page-sub">ì¬ë¬´ë¹„ìœ¨Â·ìì‚°Â·ë¶€ì±„Â·ìë³¸ í˜„í™©</p>

    <div style="display:flex;gap:8px;margin-bottom:16px;">
      <button class="tab-btn active" id="p8-con-btn" style="border:1px solid var(--border);border-radius:var(--radius-sm);" onclick="setP8('ì—°ê²°')">ì—°ê²°</button>
      <button class="tab-btn" id="p8-sep-btn" style="border:1px solid var(--border);border-radius:var(--radius-sm);" onclick="setP8('ë³„ë„')">ë³„ë„</button>
    </div>

    <div class="kpi-grid kpi-3">
      <div class="kpi-card">
        <div class="kpi-label">ë¶€ì±„ë¹„ìœ¨</div>
        <div class="kpi-value sm" id="p8-debt-ratio">174.8%</div>
        <div class="kpi-badges"><span class="badge b-dn" id="p8-debt-badge">ì „ë…„ë¹„ â–³4.5%p</span></div>
      </div>
      <div class="kpi-card">
        <div class="kpi-label">ìœ ë™ë¹„ìœ¨</div>
        <div class="kpi-value sm" id="p8-cur-ratio">147.9%</div>
        <div class="kpi-badges"><span class="badge b-up" id="p8-cur-badge">ì „ë…„ë¹„ +4.0%p</span></div>
      </div>
      <div class="kpi-card">
        <div class="kpi-label">ìê¸°ìë³¸ë¹„ìœ¨</div>
        <div class="kpi-value sm" id="p8-eq-ratio">36.4%</div>
        <div class="kpi-badges"><span class="badge b-up" id="p8-eq-badge">ì „ë…„ë¹„ +1.2%p</span></div>
      </div>
    </div>

    <div class="grid2">
      <div class="card">
        <div class="card-title" id="p8-asset-title">ìì‚° (ì—°ê²°)</div>
        <div class="metric-row"><span class="metric-key">ìì‚° ì´ê³„</span><span class="metric-val txt-up" id="p8-total-asset">277,917ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ìœ ë™ìì‚°</span><span class="metric-val" id="p8-cur-asset">219,580ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ê³µì‚¬ë¯¸ìˆ˜</span><span class="metric-val txt-up" id="p8-recv">107,797ì–µ (+15,232)</span></div>
        <div class="metric-row"><span class="metric-key">í˜„ê¸ˆì„±ìì‚°</span><span class="metric-val txt-dn" id="p8-cash">51,769ì–µ (â–³2,195)</span></div>
        <div class="metric-row"><span class="metric-key">ë¹„ìœ ë™ìì‚°</span><span class="metric-val" id="p8-noncur">58,337ì–µ</span></div>
      </div>
      <div class="card">
        <div class="card-title" id="p8-liab-title">ë¶€ì±„Â·ìë³¸ (ì—°ê²°)</div>
        <div class="metric-row"><span class="metric-key">ë¶€ì±„ ì´ê³„</span><span class="metric-val txt-dn" id="p8-total-liab">176,787ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ë‹¨ê¸°ì°¨ì…ê¸ˆ</span><span class="metric-val txt-dn" id="p8-st-debt">+4,038ì–µ ì¦ê°€</span></div>
        <div class="metric-row"><span class="metric-key">ì´ˆê³¼ì²­êµ¬ê³µì‚¬</span><span class="metric-val txt-dn" id="p8-over">98,612ì–µ (â–³2,761)</span></div>
        <div class="metric-row"><span class="metric-key">ìë³¸ ì´ê³„</span><span class="metric-val txt-up" id="p8-equity">101,129ì–µ</span></div>
        <div class="metric-row"><span class="metric-key">ì´ìµì‰ì—¬ê¸ˆ</span><span class="metric-val txt-up" id="p8-retained">64,033ì–µ (+2,731)</span></div>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ë¶€ì±„ë¹„ìœ¨ ì¶”ì´</div>
      <div class="chart-wrap" style="height:160px">
        <canvas id="p8-debt-chart"></canvas>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â• PAGE 9: ê²½ìŸì‚¬ â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-8">
    <p class="page-sub">í˜„ëŒ€ê±´ì„¤ vs ê²½ìŸì‚¬ ì£¼ìš” ì§€í‘œ ë¹„êµ (ìµœê·¼ ê³µì‹œ ê¸°ì¤€)</p>

    <div class="card">
      <div class="tbl-wrap">
        <table class="dt" style="min-width:500px;">
          <thead>
            <tr><th>êµ¬ë¶„</th><th>í˜„ëŒ€ê±´ì„¤ â­</th><th>ì‚¼ì„±ë¬¼ì‚°</th><th>ëŒ€ìš°ê±´ì„¤</th><th>GSê±´ì„¤</th><th>DL E&C</th><th>ì‚¼ì„±E&A</th></tr>
          </thead>
          <tbody>
            <tr class="group"><td>ë§¤ì¶œ(ì¡°ì›)</td><td class="txt-blue">16.5</td><td>19.8</td><td>9.2</td><td>11.3</td><td>6.8</td><td>8.5</td></tr>
            <tr><td>ì˜ì—…ì´ìµ(ì–µ)</td><td class="txt-gold">2,512</td><td class="txt-up" style="color:#059669">8,120</td><td>3,210</td><td>1,890</td><td>1,540</td><td>4,230</td></tr>
            <tr class="group"><td>ì˜ì—…ì´ìµë¥ </td><td class="txt-gold">1.5%</td><td style="color:#059669">4.1%</td><td>3.5%</td><td>1.7%</td><td>2.3%</td><td>5.0%</td></tr>
            <tr><td>ë¶€ì±„ë¹„ìœ¨</td><td>174.8%</td><td style="color:#059669">89.2%</td><td class="txt-dn">198.3%</td><td class="txt-dn">245.6%</td><td>112.4%</td><td>95.7%</td></tr>
            <tr class="group"><td>Net Cash(ì–µ)</td><td class="txt-gold">798</td><td class="txt-up">12,450</td><td class="txt-dn">â–³3,210</td><td class="txt-dn">â–³8,950</td><td class="txt-up">2,890</td><td class="txt-up">9,680</td></tr>
            <tr><td>ì‹ ìš©ë“±ê¸‰</td><td>AA-</td><td style="color:#059669">AA+</td><td>A</td><td>A+</td><td>A</td><td>AA</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ì˜ì—…ì´ìµë¥  ë¹„êµ</div>
      <div class="chart-wrap" style="height:200px">
        <canvas id="comp-chart"></canvas>
      </div>
    </div>

    <div class="card">
      <div class="card-title">ë§¤ì¶œ ê·œëª¨ ë¹„êµ (ì¡°ì›)</div>
      <div class="prog-row"><span class="prog-lbl">ì‚¼ì„±ë¬¼ì‚°</span><div class="prog-track"><div class="prog-fill" style="width:100%;background:#94a3b8;"></div></div><span class="prog-val">19.8ì¡°</span></div>
      <div class="prog-row"><span class="prog-lbl">í˜„ëŒ€ê±´ì„¤</span><div class="prog-track"><div class="prog-fill" style="width:83%;background:#3b82f6;"></div></div><span class="prog-val txt-blue">16.5ì¡°</span></div>
      <div class="prog-row"><span class="prog-lbl">GSê±´ì„¤</span><div class="prog-track"><div class="prog-fill" style="width:57%;background:#94a3b8;"></div></div><span class="prog-val">11.3ì¡°</span></div>
      <div class="prog-row"><span class="prog-lbl">ì‚¼ì„±E&A</span><div class="prog-track"><div class="prog-fill" style="width:43%;background:#94a3b8;"></div></div><span class="prog-val">8.5ì¡°</span></div>
      <div class="prog-row"><span class="prog-lbl">ëŒ€ìš°ê±´ì„¤</span><div class="prog-track"><div class="prog-fill" style="width:46%;background:#94a3b8;"></div></div><span class="prog-val">9.2ì¡°</span></div>
      <div class="prog-row"><span class="prog-lbl">DL E&C</span><div class="prog-track"><div class="prog-fill" style="width:34%;background:#94a3b8;"></div></div><span class="prog-val">6.8ì¡°</span></div>
    </div>
  </div>

  </div><!-- /pages -->
</div><!-- /main -->

<script>
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// REAL DATA (from ì§€ê¸‰ë³´ì¦DB.xlsx)
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const PF_DATA = {
  jb_current: 131443, jb_prev: 127397, jb_prev_yr: 123522,
  cp_current: 102048, cp_prev: 104304, cp_prev_yr: 96701,
  total: 233491, total_prev: 231701, total_prev_yr: 220223,
  bridge: 24004, bon_pf: 209487,
  region: {"ì„œìš¸":97172,"6ëŒ€ê´‘ì—­ì‹œ":13874,"ìˆ˜ë„ê¶Œ":12055,"ì§€ë°©":6872,"ê¸°íƒ€":1469},
  expiry: {"2026-02":13278,"2026-03":4396,"2026-04":6359,"2026-05":1003,"2026-06":2412,"2026-07":2355,"2026-08":1558,"2026-09":1661,"2026-10":2400,"2026-11":2205,"2026-12":1063,"2027-01":1405,"2027-04":5292,"2027-05":4928},
  cp_sites: [
    {code:"J881",name:"ííŠ¼í˜¸í…” ê°œë°œì‚¬ì—…",amount_ì–µ:16854,expiry:"2027-05-26"},
    {code:"J911",name:"ë” íŒŒí¬ ì‚¬ì´ë“œ ì„œìš¸",amount_ì–µ:12664,expiry:"2027-04-12"},
    {code:"GH62",name:"ê°€ì–‘ë™ CJ ê°œë°œì‚¬ì—…",amount_ì–µ:7790,expiry:"2029-10-20"},
    {code:"ë¥´ë©”ë¥´ë””ì•™",name:"ë¥´ë©”ë¥´ë””ì•™ ê°œë°œì‚¬ì—…",amount_ì–µ:7460,expiry:"2027-11-26"},
    {code:"GI58",name:"ì˜ì •ë¶€ í˜¸ì›ë™ ì„ëŒ€ì£¼íƒ",amount_ì–µ:7444,expiry:"2028-01-30"},
    {code:"GK01",name:"íìŠ¤ ë¼êµ° ì¸ í…Œë¼ìŠ¤ 2ì°¨",amount_ì–µ:5477,expiry:"2026-07-02"},
    {code:"GM75",name:"ëŒ€ì „ ë„ì•ˆ2-2ì§€êµ¬ ì¬ê±´ì¶•",amount_ì–µ:4276,expiry:"2028-02-29"},
    {code:"GM89",name:"íìŠ¤ ì´ìˆ˜ì—­ì„¼íŠ¸ëŸ´",amount_ì–µ:3650,expiry:"2028-07-15"},
    {code:"GK54",name:"íìŠ¤ ë”ì›¨ì´ë¸Œì‹œí‹°",amount_ì–µ:3436,expiry:"2027-02-28"},
    {code:"GJ73",name:"ëŒ€ì „ ìœ ì²œë™ ì£¼ìƒë³µí•©",amount_ì–µ:2860,expiry:"2026-07-14"},
    {code:"GI53",name:"ëŒ€êµ¬ ëŒ€ëª…ë™ ì£¼ìƒë³µí•© 2ì°¨",amount_ì–µ:2560,expiry:"2026-02-21"},
    {code:"J937",name:"ì„œì´ˆë™ ì˜¤í”¼ìŠ¤ ìš©ì—­",amount_ì–µ:2000,expiry:"2028-04-25"},
    {code:"GJ69",name:"ë¶€ì‚° ê°€ì•¼ë™ ê³µë™ì£¼íƒ 1ì°¨",amount_ì–µ:1999,expiry:"2027-02-22"},
    {code:"GJ78",name:"íìŠ¤ ë‘”ì‚°",amount_ì–µ:1908,expiry:"2026-10-21"},
    {code:"GI51",name:"ëŒ€ì „ ì„ í™”ë™ ì£¼ìƒë³µí•©",amount_ì–µ:1669,expiry:"2026-05-04"},
    {code:"GK55",name:"ë§ˆí¬ ì‹ ìˆ˜ë™ ì§€ì—­ì£¼íƒ",amount_ì–µ:1642,expiry:"2027-01-30"},
    {code:"GK80",name:"ìƒë„ë™ ì§€ì—­ì£¼íƒì¡°í•©",amount_ì–µ:1613,expiry:"2027-04-25"},
    {code:"GJ20",name:"ìš¸ì‚° ì•¼ìŒë™ ì£¼ìƒë³µí•©",amount_ì–µ:1600,expiry:"2028-08-13"},
    {code:"GL98",name:"ê°•ë‚¨êµ¬ ì²­ë‹´ë™(íš¨ì„±ë¹Œë¼ ë¶€ì§€)",amount_ì–µ:1536,expiry:"2028-08-30"},
    {code:"GJ40",name:"ë”ê°¤ëŸ¬ë¦¬832",amount_ì–µ:1450,expiry:"2026-11-24"},
  ],
  trend: [
    {d:"2022-12",jb:92678,cp:96634,total:189312},
    {d:"2023-03",jb:95992,cp:95315,total:191307},
    {d:"2023-06",jb:101884,cp:106260,total:208145},
    {d:"2023-09",jb:100231,cp:108578,total:208809},
    {d:"2023-12",jb:109874,cp:107634,total:217507},
    {d:"2024-03",jb:109290,cp:105710,total:215000},
    {d:"2024-06",jb:113612,cp:100168,total:213780},
    {d:"2024-09",jb:118548,cp:101443,total:219991},
    {d:"2024-12",jb:123966,cp:100968,total:224934},
    {d:"2025-03",jb:122523,cp:93973,total:216496},
    {d:"2025-06",jb:112621,cp:110310,total:222932},
    {d:"2025-09",jb:124403,cp:103741,total:228143},
    {d:"2025-12",jb:127397,cp:104304,total:231701},
    {d:"2026-01",jb:131443,cp:102048,total:233491},
  ]
};

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// SIDEBAR CONTROLS
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const sidebar = document.getElementById('sidebar');
const mainEl = document.getElementById('main');
const overlay = document.getElementById('overlay');

function isMobile() { return window.innerWidth < 900; }

function toggleSidebar() {
  if (sidebar.classList.contains('collapsed')) {
    openSidebar();
  } else {
    closeSidebar();
  }
}

function openSidebar() {
  sidebar.classList.remove('collapsed');
  if (isMobile()) {
    overlay.classList.add('show');
    mainEl.classList.add('full');
  } else {
    mainEl.classList.remove('full');
  }
}

function closeSidebar() {
  sidebar.classList.add('collapsed');
  mainEl.classList.add('full');
  overlay.classList.remove('show');
}

// Responsive init
function initLayout() {
  if (isMobile()) {
    sidebar.classList.add('collapsed');
    mainEl.classList.add('full');
  } else {
    sidebar.classList.remove('collapsed');
    mainEl.classList.remove('full');
  }
}

window.addEventListener('resize', initLayout);
initLayout();

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE NAVIGATION
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const pageTitles = ['ê²½ì˜ì‹¤ì  í†µí•©','ê²½ì˜ì‹¤ì  ë³¸ë¶€ë³„','ìœ ë™ì„± / ë¯¸ìˆ˜ì±„ê¶Œ','PFí˜„í™©','ì›ê°€ìœ¨ ì¦ê° íš¨ê³¼','ì£¼ìš”í˜„ì¥í˜„í™©','ì—°ê²°ì‹¤ì ','ì¬ë¬´ì œí‘œ','ê²½ìŸì‚¬ ë¹„êµ'];
const pagesWithTab = [0, 1];
let currentPage = 0;
let currentTab = 'cum';
let chartsInited = new Set();

function showPage(idx) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById(`page-${idx}`).classList.add('active');
  document.querySelectorAll('.nav-item')[idx].classList.add('active');
  document.getElementById('topbar-title').textContent = pageTitles[idx];
  currentPage = idx;

  const tg = document.getElementById('tab-group');
  tg.style.display = pagesWithTab.includes(idx) ? 'flex' : 'none';

  if (isMobile()) closeSidebar();

  // Init charts for this page
  setTimeout(() => initPageCharts(idx), 50);
}

function initPageCharts(idx) {
  if (chartsInited.has(idx)) return;
  chartsInited.add(idx);
  if (idx === 0) initP1Charts();
  if (idx === 1) initP2Charts();
  if (idx === 2) initP3Charts();
  if (idx === 3) initP4Charts();
  if (idx === 4) initP5Charts();
  if (idx === 6) initP7Charts();
  if (idx === 7) initP8Charts();
  if (idx === 8) initP9Charts();
  setTimeout(bindTooltips, 80);
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// TAB (ëˆ„ê³„/ë‹¹ì›”)
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function setTab(tab) {
  currentTab = tab;
  document.querySelectorAll('#tab-group .tab-btn').forEach(b => {
    b.classList.toggle('active', (tab==='cum' && b.textContent==='ëˆ„ê³„') || (tab==='month' && b.textContent==='ë‹¹ì›”'));
  });
  ['p1','p2'].forEach(p => {
    const cumEl = document.getElementById(`${p}-cum`);
    const monEl = document.getElementById(`${p}-month`);
    if (cumEl) cumEl.style.display = tab==='cum' ? '' : 'none';
    if (monEl) monEl.style.display = tab==='month' ? '' : 'none';
  });
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// CHART HELPERS
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const chartInstances = {};

function mkChart(id, config) {
  const canvas = document.getElementById(id);
  if (!canvas) return null;
  if (chartInstances[id]) { chartInstances[id].destroy(); }
  chartInstances[id] = new Chart(canvas, config);
  return chartInstances[id];
}

const defaultFont = { family: "'Noto Sans KR', sans-serif", size: 10 };
const gridColor = 'rgba(0,0,0,0.05)';
const tooltipDefaults = {
  backgroundColor: 'rgba(15,23,42,0.9)',
  titleColor: '#f8fafc',
  bodyColor: '#e2e8f0',
  borderColor: 'rgba(255,255,255,0.1)',
  borderWidth: 1,
  cornerRadius: 6,
  padding: 8,
};

function barConfig(labels, datasets, opts={}) {
  return {
    type: opts.type || 'bar',
    data: { labels, datasets },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: opts.legend || false, labels: { ...defaultFont, boxWidth: 10 } },
        tooltip: { ...tooltipDefaults }
      },
      scales: {
        x: { grid: { display: false }, ticks: { ...defaultFont, color: '#94a3b8' }, stacked: opts.stacked || false },
        y: { grid: { color: gridColor }, ticks: { ...defaultFont, color: '#94a3b8', callback: v => opts.pct ? v+'%' : (Math.abs(v)>999 ? (v/10000).toFixed(1)+'ë§Œ' : v) }, stacked: opts.stacked || false, beginAtZero: true }
      }
    }
  };
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// RICH TOOLTIP SYSTEM
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const ttEl = document.getElementById('custom-tooltip');

// Rich tooltip content map
const TOOLTIP_DATA = {
  'p1-order-kpi': () => `
    <div style="font-weight:800;font-size:13px;margin-bottom:10px;border-bottom:1px solid rgba(255,255,255,0.15);padding-bottom:8px;">ğŸ“¦ ìˆ˜ì£¼ í˜„í™© ìƒì„¸</div>
    <table style="width:100%;border-collapse:collapse;font-size:11px;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">êµ¬ë¶„</th><th style="text-align:right;padding:3px 6px;">ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ê³„íšë¹„</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë¹„</th></tr>
      <tr style="border-top:1px solid rgba(255,255,255,0.1);"><td style="padding:4px 6px;color:#93c5fd;font-weight:700;">ê³„ì—´í†µí•©</td><td style="text-align:right;padding:4px 6px;">19,941ì–µ</td><td style="text-align:right;color:#4ade80;">192.1%</td><td style="text-align:right;color:#f87171;">â–³55.8%</td></tr>
      <tr><td style="padding:4px 6px;">í˜„ëŒ€ê±´ì„¤</td><td style="text-align:right;padding:4px 6px;">17,450ì–µ</td><td style="text-align:right;color:#4ade80;">185.3%</td><td style="text-align:right;color:#f87171;">â–³52.1%</td></tr>
      <tr><td style="padding:4px 6px;">í˜„ëŒ€ì—”ì§€ë‹ˆì–´ë§</td><td style="text-align:right;padding:4px 6px;">2,491ì–µ</td><td style="text-align:right;color:#4ade80;">210.5%</td><td style="text-align:right;color:#f87171;">â–³63.2%</td></tr>
      <tr style="border-top:1px solid rgba(255,255,255,0.1);color:rgba(255,255,255,0.5);font-size:10px;"><td colspan="4" style="padding:5px 6px 0;">ë³¸ë¶€ë³„</td></tr>
      <tr><td style="padding:3px 6px;">í† ëª©</td><td style="text-align:right;padding:3px 6px;">201ì–µ</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#f87171;">â–³82.3%</td></tr>
      <tr><td style="padding:3px 6px;">ê±´ì¶•</td><td style="text-align:right;padding:3px 6px;">5,490ì–µ</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#f87171;">â–³38.1%</td></tr>
      <tr><td style="padding:3px 6px;">ì£¼íƒ</td><td style="text-align:right;padding:3px 6px;">6,854ì–µ</td><td style="text-align:right;color:#4ade80;">118.3%</td><td style="text-align:right;color:#f87171;">â–³42.0%</td></tr>
      <tr><td style="padding:3px 6px;">í”ŒëœíŠ¸</td><td style="text-align:right;padding:3px 6px;">35ì–µ</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#f87171;">â–³91.2%</td></tr>
      <tr><td style="padding:3px 6px;">ë‰´ì—ë„ˆì§€</td><td style="text-align:right;padding:3px 6px;">39ì–µ</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#f87171;">â–³88.5%</td></tr>
    </table>`,
  'p1-sales-kpi': () => `
    <div style="font-weight:800;font-size:13px;margin-bottom:10px;border-bottom:1px solid rgba(255,255,255,0.15);padding-bottom:8px;">ğŸ’° ë§¤ì¶œ í˜„í™© ìƒì„¸</div>
    <table style="width:100%;border-collapse:collapse;font-size:11px;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">êµ¬ë¶„</th><th style="text-align:right;padding:3px 6px;">ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ê³„íšë¹„</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë¹„</th></tr>
      <tr style="border-top:1px solid rgba(255,255,255,0.1);"><td style="padding:4px 6px;color:#fbbf24;font-weight:700;">ê³„ì—´í†µí•©</td><td style="text-align:right;padding:4px 6px;">19,941ì–µ</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#f87171;">â–³2.2%</td></tr>
      <tr><td style="padding:4px 6px;">í˜„ëŒ€ê±´ì„¤</td><td style="text-align:right;padding:4px 6px;">17,533ì–µ</td><td style="text-align:right;color:#94a3b8;">98.5%</td><td style="text-align:right;color:#f87171;">â–³1.8%</td></tr>
      <tr><td style="padding:4px 6px;">í˜„ëŒ€ì—”ì§€ë‹ˆì–´ë§</td><td style="text-align:right;padding:4px 6px;">2,491ì–µ</td><td style="text-align:right;color:#4ade80;">103.2%</td><td style="text-align:right;color:#4ade80;">+3.5%</td></tr>
      <tr style="border-top:1px solid rgba(255,255,255,0.1);color:rgba(255,255,255,0.5);font-size:10px;"><td colspan="4" style="padding:5px 6px 0;">ë³¸ë¶€ë³„</td></tr>
      <tr><td style="padding:3px 6px;">í† ëª©</td><td style="text-align:right;padding:3px 6px;">1,595ì–µ</td><td style="text-align:right;color:#94a3b8;">98.9%</td><td style="text-align:right;color:#f87171;">â–³3.2%</td></tr>
      <tr><td style="padding:3px 6px;">ê±´ì¶•</td><td style="text-align:right;padding:3px 6px;">1,509ì–µ</td><td style="text-align:right;color:#4ade80;">103.1%</td><td style="text-align:right;color:#4ade80;">+2.1%</td></tr>
      <tr><td style="padding:3px 6px;">ì£¼íƒ</td><td style="text-align:right;padding:3px 6px;">4,745ì–µ</td><td style="text-align:right;color:#4ade80;">118.3%</td><td style="text-align:right;color:#4ade80;">+5.8%</td></tr>
      <tr><td style="padding:3px 6px;">í”ŒëœíŠ¸</td><td style="text-align:right;padding:3px 6px;">2,970ì–µ</td><td style="text-align:right;color:#f87171;">92.3%</td><td style="text-align:right;color:#f87171;">â–³4.1%</td></tr>
      <tr><td style="padding:3px 6px;">ë‰´ì—ë„ˆì§€</td><td style="text-align:right;padding:3px 6px;">714ì–µ</td><td style="text-align:right;color:#f87171;">92.3%</td><td style="text-align:right;color:#4ade80;">+8.2%</td></tr>
    </table>`,
  'p1-profit-kpi': () => `
    <div style="font-weight:800;font-size:13px;margin-bottom:10px;border-bottom:1px solid rgba(255,255,255,0.15);padding-bottom:8px;">ğŸ“Š ê²½ìƒì†ìµ í˜„í™© ìƒì„¸</div>
    <table style="width:100%;border-collapse:collapse;font-size:11px;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">êµ¬ë¶„</th><th style="text-align:right;padding:3px 6px;">ê²½ìƒì†ìµ</th><th style="text-align:right;padding:3px 6px;">ì†ìµë¥ </th><th style="text-align:right;padding:3px 6px;">ê³„íšë¹„</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë¹„</th></tr>
      <tr style="border-top:1px solid rgba(255,255,255,0.1);"><td style="padding:4px 6px;color:#fbbf24;font-weight:700;">ê³„ì—´í†µí•©</td><td style="text-align:right;padding:4px 6px;">825ì–µ</td><td style="text-align:right;color:#fbbf24;">4.2%</td><td style="text-align:right;color:#f87171;">88.5%</td><td style="text-align:right;color:#f87171;">â–³12.3%</td></tr>
      <tr><td style="padding:4px 6px;">í˜„ëŒ€ê±´ì„¤</td><td style="text-align:right;padding:4px 6px;">712ì–µ</td><td style="text-align:right;color:#fbbf24;">4.1%</td><td style="text-align:right;color:#f87171;">86.1%</td><td style="text-align:right;color:#f87171;">â–³14.1%</td></tr>
      <tr><td style="padding:4px 6px;">í˜„ëŒ€ì—”ì§€ë‹ˆì–´ë§</td><td style="text-align:right;padding:4px 6px;">113ì–µ</td><td style="text-align:right;color:#fbbf24;">4.5%</td><td style="text-align:right;color:#94a3b8;">96.6%</td><td style="text-align:right;color:#4ade80;">+8.7%</td></tr>
      <tr style="border-top:1px solid rgba(255,255,255,0.1);color:rgba(255,255,255,0.5);font-size:10px;"><td colspan="5" style="padding:5px 6px 0;">ë³¸ë¶€ë³„</td></tr>
      <tr><td style="padding:3px 6px;">í† ëª©</td><td style="text-align:right;padding:3px 6px;">92ì–µ</td><td style="text-align:right;color:#4ade80;">5.8%</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#4ade80;">+8.2%</td></tr>
      <tr><td style="padding:3px 6px;">ê±´ì¶•</td><td style="text-align:right;padding:3px 6px;color:#f87171;">â–³301ì–µ</td><td style="text-align:right;color:#f87171;">â€”</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#f87171;">ì ìì „í™˜</td></tr>
      <tr><td style="padding:3px 6px;">ì£¼íƒ</td><td style="text-align:right;padding:3px 6px;">253ì–µ</td><td style="text-align:right;color:#4ade80;">5.3%</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#4ade80;">+12.4%</td></tr>
      <tr><td style="padding:3px 6px;">í”ŒëœíŠ¸</td><td style="text-align:right;padding:3px 6px;">172ì–µ</td><td style="text-align:right;color:#4ade80;">5.8%</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#4ade80;">+3.6%</td></tr>
      <tr><td style="padding:3px 6px;">ë‰´ì—ë„ˆì§€</td><td style="text-align:right;padding:3px 6px;">54ì–µ</td><td style="text-align:right;color:#4ade80;">7.6%</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#4ade80;">+22.7%</td></tr>
    </table>`,
  'p1-row-total': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ“Š ê³„ì—´í†µí•© ì „ë…„ë™ì›” ë¹„êµ</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">ì§€í‘œ</th><th style="text-align:right;padding:3px 6px;">ë‹¹ì›”</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë™ì›”</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë¹„</th></tr>
      <tr><td style="padding:4px 6px;">ìˆ˜ì£¼</td><td style="text-align:right;">19,941ì–µ</td><td style="text-align:right;color:#94a3b8;">45,086ì–µ</td><td style="text-align:right;color:#f87171;">â–³55.8%</td></tr>
      <tr><td style="padding:4px 6px;">ë§¤ì¶œ</td><td style="text-align:right;">17,533ì–µ</td><td style="text-align:right;color:#94a3b8;">17,920ì–µ</td><td style="text-align:right;color:#f87171;">â–³2.2%</td></tr>
      <tr><td style="padding:4px 6px;">ê²½ìƒì†ìµ</td><td style="text-align:right;">825ì–µ</td><td style="text-align:right;color:#94a3b8;">941ì–µ</td><td style="text-align:right;color:#f87171;">â–³12.3%</td></tr>
      <tr><td style="padding:4px 6px;">ì†ìµë¥ </td><td style="text-align:right;color:#fbbf24;">4.2%</td><td style="text-align:right;color:#94a3b8;">5.3%</td><td style="text-align:right;color:#f87171;">â–³1.1%p</td></tr>
    </table>`,
  'p1-row-hec': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ¢ í˜„ëŒ€ê±´ì„¤ ì „ë…„ë™ì›” ë¹„êµ</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">ì§€í‘œ</th><th style="text-align:right;padding:3px 6px;">ë‹¹ì›”</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë™ì›”</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë¹„</th></tr>
      <tr><td style="padding:4px 6px;">ìˆ˜ì£¼</td><td style="text-align:right;">17,450ì–µ</td><td style="text-align:right;color:#94a3b8;">36,435ì–µ</td><td style="text-align:right;color:#f87171;">â–³52.1%</td></tr>
      <tr><td style="padding:4px 6px;">ë§¤ì¶œ</td><td style="text-align:right;">17,533ì–µ</td><td style="text-align:right;color:#94a3b8;">17,855ì–µ</td><td style="text-align:right;color:#f87171;">â–³1.8%</td></tr>
      <tr><td style="padding:4px 6px;">ê²½ìƒì†ìµ</td><td style="text-align:right;">712ì–µ</td><td style="text-align:right;color:#94a3b8;">829ì–µ</td><td style="text-align:right;color:#f87171;">â–³14.1%</td></tr>
      <tr><td style="padding:4px 6px;">ì†ìµë¥ </td><td style="text-align:right;color:#fbbf24;">4.1%</td><td style="text-align:right;color:#94a3b8;">4.6%</td><td style="text-align:right;color:#f87171;">â–³0.5%p</td></tr>
    </table>`,
  'p1-row-hei': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ— í˜„ëŒ€ì—”ì§€ë‹ˆì–´ë§ ì „ë…„ë™ì›” ë¹„êµ</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">ì§€í‘œ</th><th style="text-align:right;padding:3px 6px;">ë‹¹ì›”</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë™ì›”</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë¹„</th></tr>
      <tr><td style="padding:4px 6px;">ìˆ˜ì£¼</td><td style="text-align:right;">2,491ì–µ</td><td style="text-align:right;color:#94a3b8;">6,778ì–µ</td><td style="text-align:right;color:#f87171;">â–³63.2%</td></tr>
      <tr><td style="padding:4px 6px;">ë§¤ì¶œ</td><td style="text-align:right;">2,491ì–µ</td><td style="text-align:right;color:#94a3b8;">2,406ì–µ</td><td style="text-align:right;color:#4ade80;">+3.5%</td></tr>
      <tr><td style="padding:4px 6px;">ê²½ìƒì†ìµ</td><td style="text-align:right;">113ì–µ</td><td style="text-align:right;color:#94a3b8;">104ì–µ</td><td style="text-align:right;color:#4ade80;">+8.7%</td></tr>
      <tr><td style="padding:4px 6px;">ì†ìµë¥ </td><td style="text-align:right;color:#fbbf24;">4.5%</td><td style="text-align:right;color:#94a3b8;">4.3%</td><td style="text-align:right;color:#4ade80;">+0.2%p</td></tr>
    </table>`,
  'p2-order-í† ëª©': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ”µ í† ëª©ë³¸ë¶€ ìˆ˜ì£¼ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ì›”</th></tr>
      <tr><td style="padding:4px 6px;">GTX-B 1ê³µêµ¬</td><td style="text-align:right;">2,638ì–µ</td><td style="text-align:right;color:#94a3b8;">'25.09</td></tr>
      <tr><td style="padding:4px 6px;">GTX-B 4ê³µêµ¬</td><td style="text-align:right;">1,880ì–µ</td><td style="text-align:right;color:#94a3b8;">'25.11</td></tr>
      <tr><td style="padding:4px 6px;">ê¸°íƒ€</td><td style="text-align:right;">201ì–µ</td><td style="text-align:right;color:#94a3b8;">'26.01</td></tr>
    </table>`,
  'p2-order-ê±´ì¶•': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸŸ£ ê±´ì¶•ë³¸ë¶€ ìˆ˜ì£¼ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ì›”</th></tr>
      <tr><td style="padding:4px 6px;">GBC ì‹ ì¶•ê³µì‚¬</td><td style="text-align:right;">17,923ì–µ</td><td style="text-align:right;color:#94a3b8;">'25.06</td></tr>
      <tr><td style="padding:4px 6px;">AABA (SKì˜¨)</td><td style="text-align:right;">12,214ì–µ</td><td style="text-align:right;color:#94a3b8;">'24.08</td></tr>
      <tr><td style="padding:4px 6px;">GBC ê³µê³µê¸°ì—¬</td><td style="text-align:right;">2,029ì–µ</td><td style="text-align:right;color:#94a3b8;">'25.03</td></tr>
      <tr><td style="padding:4px 6px;">AWS ë°ì´í„°ì„¼í„°</td><td style="text-align:right;">2,373ì–µ</td><td style="text-align:right;color:#94a3b8;">'25.01</td></tr>
      <tr><td style="padding:4px 6px;">ê¸°íƒ€</td><td style="text-align:right;">5,490ì–µ</td><td style="text-align:right;color:#94a3b8;">ëˆ„ê³„</td></tr>
    </table>`,
  'p2-order-ì£¼íƒ': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸŸ¡ ì£¼íƒë³¸ë¶€ ìˆ˜ì£¼ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ì›”</th></tr>
      <tr><td style="padding:4px 6px;">íìŠ¤ ë™íƒ„ ë ˆì´í¬íŒŒí¬</td><td style="text-align:right;">3,210ì–µ</td><td style="text-align:right;color:#94a3b8;">'26.01</td></tr>
      <tr><td style="padding:4px 6px;">íìŠ¤ ë¼êµ° ì¸ ì œì£¼</td><td style="text-align:right;">1,840ì–µ</td><td style="text-align:right;color:#94a3b8;">'26.01</td></tr>
      <tr><td style="padding:4px 6px;">ê¸°íƒ€ ë„ì‹œì •ë¹„</td><td style="text-align:right;">1,804ì–µ</td><td style="text-align:right;color:#94a3b8;">'26.01</td></tr>
    </table>`,
  'p2-order-í”ŒëœíŠ¸': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ”´ í”ŒëœíŠ¸ë³¸ë¶€ ìˆ˜ì£¼ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ì›”</th></tr>
      <tr><td style="padding:4px 6px;">ALOM ì•Œì œë¦¬</td><td style="text-align:right;">35ì–µ</td><td style="text-align:right;color:#94a3b8;">'26.01</td></tr>
      <tr><td style="padding:4px 6px;color:#94a3b8;">(í•´ì™¸ ìˆ˜ì£¼ ë¶€ì§„)</td><td style="text-align:right;color:#94a3b8;">â€”</td><td style="text-align:right;color:#94a3b8;">â€”</td></tr>
    </table>`,
  'p2-order-ë‰´ì—ë„ˆì§€': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸŸ¢ ë‰´ì—ë„ˆì§€ë³¸ë¶€ ìˆ˜ì£¼ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ì›”</th></tr>
      <tr><td style="padding:4px 6px;">Actis íŒ€ë¶íˆ¬ ë°ì´í„°ì„¼í„°</td><td style="text-align:right;">39ì–µ</td><td style="text-align:right;color:#94a3b8;">'26.01</td></tr>
    </table>`,
  'p3-cash': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ’µ í˜„ê¸ˆìœ ë™ì„± ìƒì„¸</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">êµ¬ë¶„</th><th style="text-align:right;padding:3px 6px;">ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ì „ì›”ë¹„</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë§ë¹„</th></tr>
      <tr><td style="padding:4px 6px;">í˜„ê¸ˆì„±ìì‚°</td><td style="text-align:right;">51,769ì–µ</td><td style="text-align:right;color:#f87171;">â–³2,195</td><td style="text-align:right;color:#f87171;">â–³3,211</td></tr>
      <tr><td style="padding:4px 6px;">ì°¨ì…ê¸ˆ</td><td style="text-align:right;">40,256ì–µ</td><td style="text-align:right;color:#f87171;">+2,557</td><td style="text-align:right;color:#f87171;">+2,987</td></tr>
      <tr><td style="padding:4px 6px;font-weight:700;">Net-Cash</td><td style="text-align:right;font-weight:700;">798ì–µ</td><td style="text-align:right;color:#f87171;">â–³7,780</td><td style="text-align:right;color:#f87171;">â–³8,210</td></tr>
    </table>`,
  'p3-netcash': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ’° Net-Cash ë³¸ë¶€ë³„ ìƒì„¸</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">ë³¸ë¶€</th><th style="text-align:right;padding:3px 6px;">í˜„ê¸ˆ</th><th style="text-align:right;padding:3px 6px;">ì°¨ì…ê¸ˆ</th><th style="text-align:right;padding:3px 6px;">Net</th></tr>
      <tr><td style="padding:4px 6px;">í† ëª©</td><td style="text-align:right;">8,200ì–µ</td><td style="text-align:right;">4,100ì–µ</td><td style="text-align:right;color:#4ade80;">+4,100</td></tr>
      <tr><td style="padding:4px 6px;">ê±´ì¶•</td><td style="text-align:right;">6,500ì–µ</td><td style="text-align:right;">8,200ì–µ</td><td style="text-align:right;color:#f87171;">â–³1,700</td></tr>
      <tr><td style="padding:4px 6px;">ì£¼íƒ</td><td style="text-align:right;">18,000ì–µ</td><td style="text-align:right;">21,000ì–µ</td><td style="text-align:right;color:#f87171;">â–³3,000</td></tr>
      <tr><td style="padding:4px 6px;">í”ŒëœíŠ¸</td><td style="text-align:right;">15,200ì–µ</td><td style="text-align:right;">5,800ì–µ</td><td style="text-align:right;color:#4ade80;">+9,400</td></tr>
      <tr><td style="padding:4px 6px;">ë‰´ì—ë„ˆì§€</td><td style="text-align:right;">3,869ì–µ</td><td style="text-align:right;">1,156ì–µ</td><td style="text-align:right;color:#4ade80;">+2,713</td></tr>
    </table>`,
  'p3-debt': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ¦ ì°¨ì…ê¸ˆ ìƒì„¸</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">êµ¬ë¶„</th><th style="text-align:right;padding:3px 6px;">ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ì „ì›”ë¹„</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë§ë¹„</th></tr>
      <tr><td style="padding:4px 6px;">ë‹¨ê¸°ì°¨ì…ê¸ˆ</td><td style="text-align:right;">24,600ì–µ</td><td style="text-align:right;color:#f87171;">+4,038</td><td style="text-align:right;color:#f87171;">+5,200</td></tr>
      <tr><td style="padding:4px 6px;">ì¥ê¸°ì°¨ì…ê¸ˆ</td><td style="text-align:right;">15,656ì–µ</td><td style="text-align:right;color:#4ade80;">â–³1,481</td><td style="text-align:right;color:#4ade80;">â–³2,213</td></tr>
      <tr><td style="padding:4px 6px;font-weight:700;">í•©ê³„</td><td style="text-align:right;font-weight:700;">40,256ì–µ</td><td style="text-align:right;color:#f87171;">+2,557</td><td style="text-align:right;color:#f87171;">+2,987</td></tr>
    </table>`,
  'p3-mis': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ“‹ ë¯¸ìˆ˜ì±„ê¶Œ ë³¸ë¶€ë³„ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">ë³¸ë¶€/í˜„ì¥</th><th style="text-align:right;padding:3px 6px;">ë‹¹ì›”</th><th style="text-align:right;padding:3px 6px;">ì „ì›”ë¹„</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë§ë¹„</th></tr>
      <tr><td style="padding:4px 6px;">í† ëª©</td><td style="text-align:right;">15,322ì–µ</td><td style="text-align:right;color:#f87171;">â–³2,089</td><td style="text-align:right;color:#f87171;">â–³3,100</td></tr>
      <tr><td style="padding:4px 6px;">ê±´ì¶•</td><td style="text-align:right;">7,728ì–µ</td><td style="text-align:right;color:#4ade80;">+2,141</td><td style="text-align:right;color:#4ade80;">+1,800</td></tr>
      <tr><td style="padding:4px 6px;">ì£¼íƒ</td><td style="text-align:right;">41,359ì–µ</td><td style="text-align:right;color:#4ade80;">+3,189</td><td style="text-align:right;color:#4ade80;">+8,200</td></tr>
      <tr><td style="padding:4px 6px;">í”ŒëœíŠ¸</td><td style="text-align:right;">12,660ì–µ</td><td style="text-align:right;color:#4ade80;">+4,545</td><td style="text-align:right;color:#4ade80;">+6,700</td></tr>
      <tr><td style="padding:4px 6px;">ë‰´ì—ë„ˆì§€</td><td style="text-align:right;">5,967ì–µ</td><td style="text-align:right;color:#4ade80;">+675</td><td style="text-align:right;color:#4ade80;">+1,300</td></tr>
    </table>`,
  'p3-micheong': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ“‹ ë¯¸ì²­êµ¬ì±„ê¶Œ ë³¸ë¶€ë³„ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">ë³¸ë¶€/í˜„ì¥</th><th style="text-align:right;padding:3px 6px;">ë‹¹ì›”</th><th style="text-align:right;padding:3px 6px;">ì „ì›”ë¹„</th><th style="text-align:right;padding:3px 6px;">ì „ë…„ë§ë¹„</th></tr>
      <tr><td style="padding:4px 6px;">í† ëª©</td><td style="text-align:right;">12,400ì–µ</td><td style="text-align:right;color:#f87171;">â–³800</td><td style="text-align:right;color:#f87171;">â–³2,100</td></tr>
      <tr><td style="padding:4px 6px;">ê±´ì¶•</td><td style="text-align:right;">8,200ì–µ</td><td style="text-align:right;color:#f87171;">â–³500</td><td style="text-align:right;color:#f87171;">â–³1,800</td></tr>
      <tr><td style="padding:4px 6px;">ì£¼íƒ</td><td style="text-align:right;">9,600ì–µ</td><td style="text-align:right;color:#f87171;">â–³200</td><td style="text-align:right;color:#f87171;">â–³1,500</td></tr>
      <tr><td style="padding:4px 6px;">í”ŒëœíŠ¸</td><td style="text-align:right;">9,400ì–µ</td><td style="text-align:right;color:#f87171;">â–³380</td><td style="text-align:right;color:#f87171;">â–³1,600</td></tr>
      <tr><td style="padding:4px 6px;">ë‰´ì—ë„ˆì§€</td><td style="text-align:right;">2,400ì–µ</td><td style="text-align:right;color:#f87171;">â–³220</td><td style="text-align:right;color:#f87171;">â–³476</td></tr>
    </table>`,
  'p4-jb': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ” ì§€ê¸‰ë³´ì¦ í˜„ì¥ ìƒì„¸ (Top 5)</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ë³´ì¦ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ë§Œê¸°ì¼</th><th style="text-align:right;padding:3px 6px;">ë‹¨ê³„</th></tr>
      <tr><td style="padding:4px 6px;">ìˆ˜ì„œì—­ì„¸ê¶Œ ë³µí•©ê°œë°œ</td><td style="text-align:right;">18,200ì–µ</td><td style="text-align:right;color:#94a3b8;">'28.12</td><td style="text-align:right;color:#3b82f6;">ë³¸PF</td></tr>
      <tr><td style="padding:4px 6px;">íìŠ¤ ì´ìˆ˜ì—­ì„¼íŠ¸ëŸ´</td><td style="text-align:right;">12,500ì–µ</td><td style="text-align:right;color:#94a3b8;">'27.06</td><td style="text-align:right;color:#ef4444;">ë¸Œë¦¿ì§€</td></tr>
      <tr><td style="padding:4px 6px;">ë§ˆí¬ ì‹ ìˆ˜ë™</td><td style="text-align:right;">8,900ì–µ</td><td style="text-align:right;color:#94a3b8;">'27.01</td><td style="text-align:right;color:#3b82f6;">ë³¸PF</td></tr>
      <tr><td style="padding:4px 6px;">ê°•ë‚¨ ì²­ë‹´ë™</td><td style="text-align:right;">6,800ì–µ</td><td style="text-align:right;color:#94a3b8;">'28.08</td><td style="text-align:right;color:#ef4444;">ë¸Œë¦¿ì§€</td></tr>
      <tr><td style="padding:4px 6px;">ê¸°íƒ€ (ì—°ëŒ€ë³´ì¦)</td><td style="text-align:right;">85,043ì–µ</td><td style="text-align:right;color:#94a3b8;">ë‹¤ìˆ˜</td><td style="text-align:right;color:#3b82f6;">ë³¸PF</td></tr>
    </table>`,
  'p4-cp': () => `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">âš  ì±…ì„ì¤€ê³µ í˜„ì¥ ìƒì„¸ (Top 5)</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ë³´ì¦ê¸ˆì•¡</th><th style="text-align:right;padding:3px 6px;">ë§Œê¸°ì¼</th><th style="text-align:right;padding:3px 6px;">ë‹¨ê³„</th></tr>
      <tr><td style="padding:4px 6px;color:#fbbf24;">ííŠ¼í˜¸í…” ê°œë°œì‚¬ì—…</td><td style="text-align:right;">16,854ì–µ</td><td style="text-align:right;color:#f87171;">'27.05</td><td style="text-align:right;color:#3b82f6;">ë³¸PF</td></tr>
      <tr><td style="padding:4px 6px;">ë” íŒŒí¬ ì‚¬ì´ë“œ ì„œìš¸</td><td style="text-align:right;">12,664ì–µ</td><td style="text-align:right;color:#f87171;">'27.04</td><td style="text-align:right;color:#3b82f6;">ë³¸PF</td></tr>
      <tr><td style="padding:4px 6px;">ê°€ì–‘ë™ CJ ê°œë°œì‚¬ì—…</td><td style="text-align:right;">7,790ì–µ</td><td style="text-align:right;color:#4ade80;">'29.10</td><td style="text-align:right;color:#3b82f6;">ë³¸PF</td></tr>
      <tr><td style="padding:4px 6px;">ë¥´ë©”ë¥´ë””ì•™ ê°œë°œì‚¬ì—…</td><td style="text-align:right;">7,460ì–µ</td><td style="text-align:right;color:#f87171;">'27.11</td><td style="text-align:right;color:#3b82f6;">ë³¸PF</td></tr>
      <tr><td style="padding:4px 6px;">ì˜ì •ë¶€ í˜¸ì›ë™ ì„ëŒ€ì£¼íƒ</td><td style="text-align:right;">7,444ì–µ</td><td style="text-align:right;color:#4ade80;">'28.01</td><td style="text-align:right;color:#3b82f6;">ë³¸PF</td></tr>
    </table>`,
};

// Tooltip event binding
function bindTooltips() {
  document.querySelectorAll('.tt-trigger').forEach(el => {
    const key = el.getAttribute('data-tt');
    if (!TOOLTIP_DATA[key]) return;
    const show = (e) => {
      const clientX = e.clientX || (e.touches && e.touches[0].clientX) || 0;
      const clientY = e.clientY || (e.touches && e.touches[0].clientY) || 0;
      ttEl.innerHTML = TOOLTIP_DATA[key]();
      ttEl.style.display = 'block';
      const tw = ttEl.offsetWidth, th = ttEl.offsetHeight;
      const vw = window.innerWidth, vh = window.innerHeight;
      let left = clientX + 14;
      let top = clientY + 14;
      if (left + tw > vw - 10) left = clientX - tw - 10;
      if (top + th > vh - 10) top = clientY - th - 10;
      ttEl.style.left = Math.max(6, left) + 'px';
      ttEl.style.top = Math.max(6, top) + 'px';
    };
    const hide = () => { ttEl.style.display = 'none'; };
    el.addEventListener('mouseenter', show);
    el.addEventListener('mousemove', show);
    el.addEventListener('mouseleave', hide);
    el.addEventListener('touchstart', (e) => { show(e); }, {passive:true});
    el.addEventListener('touchend', hide);
  });
}

// Chart custom tooltip for order chart
const orderMonthDetails = {
  '1ì›”': [{dept:'ì£¼íƒ',name:'íìŠ¤ ë™íƒ„ ë ˆì´í¬íŒŒí¬',amt:3210},{dept:'ì£¼íƒ',name:'íìŠ¤ ë¼êµ° ì¸ ì œì£¼',amt:1840},{dept:'ê±´ì¶•',name:'GBC ì‹ ì¶•ê³µì‚¬(ê¸°ì„±)',amt:2380},{dept:'í† ëª©',name:'GTX-B ì”ì—¬',amt:201},{dept:'í”ŒëœíŠ¸',name:'ALOM ì”ì—¬',amt:35},{dept:'ë‰´ì—ë„ˆì§€',name:'Actis DC',amt:39}],
  '12ì›”': [{dept:'ì£¼íƒ',name:'íìŠ¤ ì‚¼ì„±ì—­',amt:2800},{dept:'ê±´ì¶•',name:'ë°ì´í„°ì„¼í„° Bë™',amt:1200},{dept:'í† ëª©',name:'ì§€ë°©ë„ í™•ì¥',amt:350},{dept:'í”ŒëœíŠ¸',name:'ì—†ìŒ',amt:0}],
  '11ì›”': [{dept:'ì£¼íƒ',name:'íìŠ¤ ì„¼íŠ¸ëŸ´íŒŒí¬',amt:1800},{dept:'ê±´ì¶•',name:'ë¬¼ë¥˜ì„¼í„°',amt:980},{dept:'í† ëª©',name:'êµëŸ‰ê³µì‚¬',amt:520}],
};
const salesMonthDetails = {
  '1ì›”': [{dept:'í† ëª©',name:'GTX-B 1ê³µêµ¬',sales:180,prog:'4.2%',cost:'88.0%'},{dept:'ê±´ì¶•',name:'GBC ì‹ ì¶•ê³µì‚¬',sales:350,prog:'8.0%',cost:'91.0%'},{dept:'ì£¼íƒ',name:'íìŠ¤ ì´ìˆ˜ì—­',sales:820,prog:'65.8%',cost:'86.4%'},{dept:'í”ŒëœíŠ¸',name:'ALOM ì•Œì œë¦¬',sales:620,prog:'60.5%',cost:'82.4%'},{dept:'ë‰´ì—ë„ˆì§€',name:'Actis DC',sales:120,prog:'3.9%',cost:'89.8%'}],
};
const profitMonthDetails = {
  '1ì›”': [{dept:'í† ëª©',name:'GTX-B 1ê³µêµ¬',ë§¤ì¶œì´ìµ:11,ê²½ìƒì´ìµ:8,prog:'4.2%',cost:'88.0%'},{dept:'ê±´ì¶•',name:'GBC ì‹ ì¶•ê³µì‚¬',ë§¤ì¶œì´ìµ:-28,ê²½ìƒì´ìµ:-35,prog:'8.0%',cost:'91.0%'},{dept:'ì£¼íƒ',name:'íìŠ¤ ì´ìˆ˜ì—­',ë§¤ì¶œì´ìµ:115,ê²½ìƒì´ìµ:98,prog:'65.8%',cost:'86.4%'},{dept:'í”ŒëœíŠ¸',name:'ALOM ì•Œì œë¦¬',ë§¤ì¶œì´ìµ:110,ê²½ìƒì´ìµ:95,prog:'60.5%',cost:'82.4%'},{dept:'ë‰´ì—ë„ˆì§€',name:'Actis DC',sales:10,ë§¤ì¶œì´ìµ:12,ê²½ìƒì´ìµ:10,prog:'3.9%',cost:'89.8%'}],
};

function buildOrderTT(month) {
  const items = orderMonthDetails[month] || [];
  if (!items.length) return `<div style="font-size:12px;">${month} ìˆ˜ì£¼ ë‚´ì—­ ì—†ìŒ</div>`;
  return `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ“¦ ${month} ë³¸ë¶€ë³„ ìˆ˜ì£¼ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">ë³¸ë¶€</th><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ìˆ˜ì£¼ê¸ˆì•¡</th></tr>
      ${items.map(r=>`<tr><td style="padding:3px 6px;color:#93c5fd;">${r.dept}</td><td style="padding:3px 6px;">${r.name}</td><td style="text-align:right;padding:3px 6px;">${r.amt.toLocaleString()}ì–µ</td></tr>`).join('')}
    </table>`;
}

function buildSalesTT(month) {
  const items = salesMonthDetails[month] || salesMonthDetails['1ì›”'];
  return `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ’° ${month} ë³¸ë¶€ë³„ ë§¤ì¶œ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">ë³¸ë¶€</th><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ë§¤ì¶œ</th><th style="text-align:right;padding:3px 6px;">ì§„í–‰ë¥ </th><th style="text-align:right;padding:3px 6px;">ì›ê°€ìœ¨</th></tr>
      ${items.map(r=>`<tr><td style="padding:3px 6px;color:#fbbf24;">${r.dept}</td><td style="padding:3px 6px;">${r.name}</td><td style="text-align:right;padding:3px 6px;">${r.sales}ì–µ</td><td style="text-align:right;padding:3px 6px;">${r.prog}</td><td style="text-align:right;padding:3px 6px;color:${parseFloat(r.cost)>95?'#f87171':'#4ade80'}">${r.cost}</td></tr>`).join('')}
    </table>`;
}

function buildProfitTT(month) {
  const items = profitMonthDetails[month] || profitMonthDetails['1ì›”'];
  return `<div style="font-weight:800;font-size:13px;margin-bottom:8px;">ğŸ“Š ${month} ë³¸ë¶€ë³„ ì†ìµ í˜„í™©</div>
    <table style="font-size:11px;width:100%;border-collapse:collapse;">
      <tr style="color:rgba(255,255,255,0.5);"><th style="text-align:left;padding:3px 6px;">ë³¸ë¶€</th><th style="text-align:left;padding:3px 6px;">í˜„ì¥ëª…</th><th style="text-align:right;padding:3px 6px;">ë§¤ì¶œì´ìµ</th><th style="text-align:right;padding:3px 6px;">ê²½ìƒì´ìµ</th><th style="text-align:right;padding:3px 6px;">ì§„í–‰ë¥ </th><th style="text-align:right;padding:3px 6px;">ì›ê°€ìœ¨</th></tr>
      ${items.map(r=>`<tr><td style="padding:3px 6px;color:#a78bfa;">${r.dept}</td><td style="padding:3px 6px;">${r.name}</td><td style="text-align:right;padding:3px 6px;color:${r.ë§¤ì¶œì´ìµ<0?'#f87171':'#4ade80'}">${r.ë§¤ì¶œì´ìµ>0?'+':''}${r.ë§¤ì¶œì´ìµ}</td><td style="text-align:right;padding:3px 6px;color:${r.ê²½ìƒì´ìµ<0?'#f87171':'#4ade80'}">${r.ê²½ìƒì´ìµ>0?'+':''}${r.ê²½ìƒì´ìµ}</td><td style="text-align:right;padding:3px 6px;">${r.prog}</td><td style="text-align:right;padding:3px 6px;color:${parseFloat(r.cost)>95?'#f87171':'#4ade80'}">${r.cost}</td></tr>`).join('')}
    </table>`;
}

// Cost detail data for P5 tooltip
const costSiteDetails = {
  '\'17': [{name:'íìŠ¤ ì„œì´ˆ ì—ì½”ë°¸ë¦¬',result:'ì•…í™”',prevCost:'82.1%',curCost:'95.3%',effect:-850},{name:'ì¹´íƒ€ë¥´ LNG 4ë‹¨ê³„',result:'ì•…í™”',prevCost:'89.2%',curCost:'102.5%',effect:-1820},{name:'GTX-A 3ê³µêµ¬',result:'ê°œì„ ',prevCost:'98.5%',curCost:'91.2%',effect:180}],
  '\'26': [{name:'GBC ì‹ ì¶•ê³µì‚¬',result:'ì•…í™”',prevCost:'88.1%',curCost:'91.0%',effect:-98},{name:'AABA SKì˜¨',result:'ì•…í™”',prevCost:'90.1%',curCost:'93.3%',effect:-82},{name:'íìŠ¤ ì„ í™”',result:'ê°œì„ ',prevCost:'63.5%',curCost:'60.6%',effect:12}],
};

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE 1 CHARTS
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function initP1Charts() {
  const months = ['2ì›”','3ì›”','4ì›”','5ì›”','6ì›”','7ì›”','8ì›”','9ì›”','10ì›”','11ì›”','12ì›”','1ì›”'];
  const orderData = [2150,3800,3200,4900,3600,5200,2900,7100,5800,4300,6500,19941];
  const salesData = [14500,15200,14800,15800,15200,16000,15400,16500,16000,16800,17200,17533];
  const profitData = [3.2,-1.8,2.8,4.1,-0.9,3.5,4.2,-1.2,5.1,5.5,5.8,4.2]; // ì†ìµë¥ 
  const profitAmt  = [464,-273,415,650,-137,560,645,-196,816,924,998,825]; // ê²½ìƒì†ìµ ì–µ

  // datalabels í”ŒëŸ¬ê·¸ì¸ì´ ì—†ìœ¼ë¯€ë¡œ afterDrawë¡œ ì§ì ‘ ê·¸ë¦¼
  const dlPlugin = {
    id: 'customDL',
    afterDatasetsDraw(chart) {
      const {ctx, data, chartArea:{top,bottom,left,right}, scales} = chart;
      ctx.save();
      chart.data.datasets.forEach((ds, di) => {
        const meta = chart.getDatasetMeta(di);
        if (meta.hidden) return;
        meta.data.forEach((bar, idx) => {
          const v = ds.data[idx];
          if (v === null || v === undefined) return;
          const x = bar.x, y = bar.y;
          ctx.font = `bold 9px 'Noto Sans KR'`;
          ctx.textAlign = 'center';
          const isNeg = v < 0;
          ctx.fillStyle = isNeg ? '#ef4444' : '#1e293b';
          const dispV = Math.abs(v) >= 10000 ? (v/10000).toFixed(1)+'ë§Œ' : v >= 1000 ? (v/1000).toFixed(0)+'ì²œ' : v;
          const labelY = isNeg ? y + 12 : y - 5;
          if (labelY > top && labelY < bottom) ctx.fillText(dispV, x, labelY);
        });
      });
      ctx.restore();
    }
  };

  mkChart('p1-order-chart', {
    type:'bar',
    data:{ labels:months, datasets:[{
      data:orderData,
      backgroundColor: orderData.map(v => v===19941?'#1a56db':'rgba(59,130,246,0.5)'),
      borderRadius:3, label:'ìˆ˜ì£¼'
    }]},
    plugins: [dlPlugin],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{
        legend:{display:false},
        tooltip:{
          ...tooltipDefaults,
          callbacks:{
            title: ctx => ctx[0].label + ' ìˆ˜ì£¼',
            afterBody: ctx => {
              const month = ctx[0].label;
              const det = orderMonthDetails[month];
              if (!det) return '';
              return '\n' + det.map(d => `  ${d.dept}: ${d.name} ${d.amt.toLocaleString()}ì–µ`).join('\n');
            }
          }
        }
      },
      scales:{
        x:{grid:{display:false},ticks:{...defaultFont,color:'#94a3b8'}},
        y:{grid:{color:gridColor},ticks:{...defaultFont,color:'#94a3b8',callback:v=>v>=1000?(v/1000)+'k':v},beginAtZero:true}
      }
    }
  });

  mkChart('p1-sales-chart', {
    type:'bar',
    data:{ labels:months, datasets:[{
      data:salesData,
      backgroundColor: salesData.map(v => v===17533?'#d97706':'rgba(251,191,36,0.5)'),
      borderRadius:3, label:'ë§¤ì¶œ'
    }]},
    plugins: [dlPlugin],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{
        legend:{display:false},
        tooltip:{
          ...tooltipDefaults,
          callbacks:{
            title: ctx => ctx[0].label + ' ë§¤ì¶œ',
            afterBody: ctx => {
              const month = ctx[0].label;
              const det = salesMonthDetails[month] || salesMonthDetails['1ì›”'];
              return '\n' + det.map(d => `  ${d.dept}: ${d.name}\n    ë§¤ì¶œ ${d.sales}ì–µ | ì§„í–‰ ${d.prog} | ì›ê°€ ${d.cost}`).join('\n');
            }
          }
        }
      },
      scales:{
        x:{grid:{display:false},ticks:{...defaultFont,color:'#94a3b8'}},
        y:{grid:{color:gridColor},ticks:{...defaultFont,color:'#94a3b8',callback:v=>v>=10000?(v/10000).toFixed(1)+'ë§Œ':v},beginAtZero:true}
      }
    }
  });

  // ê²½ìƒì†ìµ(ì†ìµë¥ ) í˜¼í•© ì°¨íŠ¸
  const dlPluginCombo = {
    id:'comboDL',
    afterDatasetsDraw(chart) {
      const {ctx, chartArea:{top,bottom}, scales} = chart;
      ctx.save();
      chart.data.datasets.forEach((ds, di) => {
        const meta = chart.getDatasetMeta(di);
        if (meta.hidden) return;
        meta.data.forEach((el, idx) => {
          const v = ds.data[idx];
          if (v === null || v === undefined) return;
          ctx.font = 'bold 9px "Noto Sans KR"';
          ctx.textAlign = 'center';
          if (ds.type === 'bar' || (!ds.type && chart.config.type === 'bar')) {
            ctx.fillStyle = v < 0 ? '#ef4444' : '#1d4ed8';
            const labelY = v < 0 ? el.y + 12 : el.y - 6;
            if (labelY > top && labelY < bottom)
              ctx.fillText((v>0?'':'')+Math.abs(v), el.x, labelY);
          } else {
            ctx.fillStyle = v < 0 ? '#ef4444' : '#d97706';
            const labelY = el.y - 8;
            if (labelY > top && labelY < bottom)
              ctx.fillText(v.toFixed(1)+'%', el.x, labelY);
          }
        });
      });
      ctx.restore();
    }
  };

  mkChart('p1-profit-chart', {
    type:'bar',
    data:{
      labels: months,
      datasets:[
        {
          type:'bar', label:'ê²½ìƒì†ìµ(ì–µì›)', data:profitAmt, yAxisID:'y',
          backgroundColor: profitAmt.map(v => v<0?'rgba(239,68,68,0.7)':'rgba(26,86,219,0.7)'),
          borderRadius:3, order:2,
        },
        {
          type:'line', label:'ì†ìµë¥ (%)', data:profitData, yAxisID:'y2',
          borderColor:'#f59e0b', backgroundColor:'transparent',
          tension:0.4, pointRadius:4,
          pointBackgroundColor: profitData.map(v=>v<0?'#ef4444':'#f59e0b'),
          borderWidth:2.5, order:1,
        }
      ]
    },
    plugins:[dlPluginCombo],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{
        legend:{display:true, labels:{...defaultFont,boxWidth:12,padding:10}},
        tooltip:{
          ...tooltipDefaults,
          callbacks:{
            title: ctx => ctx[0].label + ' ì†ìµ í˜„í™©',
            afterBody: ctx => {
              const month = ctx[0].label;
              const det = profitMonthDetails[month] || profitMonthDetails['1ì›”'];
              return '\n' + det.map(d => `  ${d.dept}: ${d.name}\n    ë§¤ì¶œì´ìµ ${d.ë§¤ì¶œì´ìµ>0?'+':''}${d.ë§¤ì¶œì´ìµ}ì–µ | ê²½ìƒ ${d.ê²½ìƒì´ìµ>0?'+':''}${d.ê²½ìƒì´ìµ}ì–µ`).join('\n');
            }
          }
        }
      },
      scales:{
        x:{grid:{display:false}, ticks:{...defaultFont,color:'#94a3b8'}},
        y:{grid:{color:gridColor}, ticks:{...defaultFont,color:'#94a3b8',callback:v=>v+'ì–µ'}, title:{display:true,text:'ê²½ìƒì†ìµ(ì–µ)',font:{size:9},color:'#94a3b8'}},
        y2:{position:'right', grid:{display:false}, ticks:{...defaultFont,color:'#d97706',callback:v=>v+'%'}, title:{display:true,text:'ì†ìµë¥ (%)',font:{size:9},color:'#d97706'}}
      }
    }
  });
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE 2 CHARTS
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const trendDatasets = {
  'ìˆ˜ì£¼': {
    í† ëª©:  [4800,4200,3900,3500,3100,2800,2500,2100,1800,1500,201],
    ì£¼íƒ:  [25000,32000,41000,55000,68000,52000,48000,65000,72000,58000,6854],
    ê±´ì¶•:  [18000,15000,22000,28000,35000,41000,38000,32000,29000,25000,5490],
    í”ŒëœíŠ¸:[8000,6500,5200,4800,5100,4200,3800,3200,2800,2100,35],
    ë‰´ì—ë„ˆì§€:[0,0,100,300,800,1200,1800,2500,3200,1800,39],
  },
  'ë§¤ì¶œ': {
    í† ëª©:  [22000,21000,20000,19000,18000,18500,17800,17000,16500,16000,1595],
    ì£¼íƒ:  [38000,42000,48000,55000,60000,65000,68000,72000,75000,58000,4745],
    ê±´ì¶•:  [15000,16000,18000,20000,22000,21000,19000,18000,17000,16000,1509],
    í”ŒëœíŠ¸:[28000,26000,24000,22000,21000,20000,22000,24000,26000,25000,2970],
    ë‰´ì—ë„ˆì§€:[0,0,200,500,1000,1500,2000,2800,3500,3200,714],
  },
  'ì†ìµ': {
    í† ëª©:  [800,700,600,500,450,500,550,600,650,700,92],
    ì£¼íƒ:  [2800,3200,3800,4200,4500,4100,3800,4200,4600,3500,253],
    ê±´ì¶•:  [800,700,900,1000,1100,900,800,700,600,500,-301],
    í”ŒëœíŠ¸:[1800,1600,1400,1200,1100,1000,1200,1400,1600,1500,172],
    ë‰´ì—ë„ˆì§€:[0,0,10,20,50,80,120,180,250,240,54],
  },
  'ë¯¸ìˆ˜ì±„ê¶Œ': {
    í† ëª©:  [28000,27000,26000,25000,24000,23000,22000,21000,20000,19000,15322],
    ì£¼íƒ:  [22000,25000,28000,32000,36000,38000,40000,42000,44000,43000,41359],
    ê±´ì¶•:  [8000,8500,9000,9500,10000,9800,9500,9200,8800,8500,7728],
    í”ŒëœíŠ¸:[16000,15500,15000,14500,14000,13800,13500,13200,13000,12800,12660],
    ë‰´ì—ë„ˆì§€:[0,0,500,1000,2000,3000,4000,5000,6000,6500,5967],
  }
};

const trendSiteDetails = {
  'ìˆ˜ì£¼': {'\'26':['íìŠ¤ ë™íƒ„','íìŠ¤ ë¼êµ° ì œì£¼','GBC','GTX-B','ALOM']},
  'ë§¤ì¶œ': {'\'26':['GTX-B 1ê³µêµ¬','GBC ì‹ ì¶•','íìŠ¤ ì´ìˆ˜ì—­','ALOM ì•Œì œë¦¬','Actis DC']},
  'ì†ìµ': {'\'26':['í† ëª© 92ì–µ','ê±´ì¶• â–³301ì–µ','ì£¼íƒ 253ì–µ','í”ŒëœíŠ¸ 172ì–µ','ë‰´ì—ë„ˆì§€ 54ì–µ']},
  'ë¯¸ìˆ˜ì±„ê¶Œ': {'\'26':['í† ëª© 15,322ì–µ','ì£¼íƒ 41,359ì–µ','ê±´ì¶• 7,728ì–µ','í”ŒëœíŠ¸ 12,660ì–µ','ë‰´ì—ë„ˆì§€ 5,967ì–µ']},
};

let currentDeptMetric = 'ìˆ˜ì£¼';
let currentDeptFilter = 'ì „ì²´';
const deptColors = { í† ëª©:'#3b82f6', ì£¼íƒ:'#f59e0b', ê±´ì¶•:'#8b5cf6', í”ŒëœíŠ¸:'#ef4444', ë‰´ì—ë„ˆì§€:'#10b981' };

function initP2Charts() { renderDeptTrend('ìˆ˜ì£¼', 'ì „ì²´'); }

function renderDeptTrend(metric, deptFilter) {
  currentDeptMetric = metric;
  currentDeptFilter = deptFilter;
  const years = ['\'16','\'17','\'18','\'19','\'20','\'21','\'22','\'23','\'24','\'25','\'26'];
  const d = trendDatasets[metric];
  let datasets;
  if (deptFilter === 'ì „ì²´') {
    datasets = Object.entries(d).map(([k,v]) => ({
      label:k, data:v,
      backgroundColor: deptColors[k]+'99',
      borderColor: deptColors[k],
      borderWidth:1.5, borderRadius:2,
    }));
  } else {
    datasets = [{
      label: deptFilter, data: d[deptFilter] || [],
      backgroundColor: deptColors[deptFilter]+'cc',
      borderColor: deptColors[deptFilter],
      borderWidth:1.5, borderRadius:3,
    }];
  }

  const dlPluginP2 = {
    id:'p2DL',
    afterDatasetsDraw(chart) {
      const {ctx, chartArea:{top,bottom}} = chart;
      ctx.save();
      chart.data.datasets.forEach((ds,di) => {
        const meta = chart.getDatasetMeta(di);
        if (meta.hidden) return;
        meta.data.forEach((bar,idx) => {
          const v = ds.data[idx];
          if (!v || v < 500) return; // ì‘ì€ê°’ ìƒëµ
          ctx.font = 'bold 8px "Noto Sans KR"';
          ctx.textAlign = 'center';
          ctx.fillStyle = '#1e293b';
          const labelY = bar.y - 4;
          if (labelY > top + 5 && labelY < bottom)
            ctx.fillText(v >= 10000 ? (v/10000).toFixed(0)+'ë§Œ' : v >= 1000 ? (v/1000).toFixed(0)+'k' : v, bar.x, labelY);
        });
      });
      ctx.restore();
    }
  };

  document.getElementById('dept-trend-label').textContent = `${metric} ê¸°ì¤€ (2016~2026) â€” ${deptFilter === 'ì „ì²´' ? 'ì „ì²´ ë³¸ë¶€' : deptFilter + 'ë³¸ë¶€'}`;
  mkChart('dept-trend-chart', {
    type:'bar',
    data:{ labels:years, datasets },
    plugins:[dlPluginP2],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{
        legend:{ display: deptFilter==='ì „ì²´', labels:{...defaultFont,boxWidth:10} },
        tooltip:{
          ...tooltipDefaults,
          callbacks:{
            title: ctx => `${ctx[0].label}ë…„ ${metric}`,
            afterBody: ctx => {
              const yr = ctx[0].label;
              const det = trendSiteDetails[metric][yr];
              if (!det) return '';
              return '\nì£¼ìš” í˜„ì¥:\n' + det.map(s=>'  â€¢ '+s).join('\n');
            }
          }
        }
      },
      scales:{
        x:{stacked:false, grid:{display:false}, ticks:{...defaultFont,color:'#94a3b8'}},
        y:{grid:{color:gridColor}, ticks:{...defaultFont,color:'#94a3b8',callback:v=>v>=10000?(v/10000).toFixed(0)+'ë§Œ':v>=1000?(v/1000)+'k':v}}
      }
    }
  });
}

function setDeptTrend(metric, btn) {
  // Only reset metric buttons (first 4)
  const metricBtns = ['ìˆ˜ì£¼','ë§¤ì¶œ','ì†ìµ','ë¯¸ìˆ˜ì±„ê¶Œ'];
  document.querySelectorAll('#page-1 .filter-row .f-btn').forEach(b => {
    if (metricBtns.includes(b.textContent)) b.classList.remove('active');
  });
  btn.classList.add('active');
  renderDeptTrend(metric, currentDeptFilter);
}

function setDeptFilter(dept, btn) {
  const deptBtns = ['ì „ì²´','í† ëª©','ê±´ì¶•','ì£¼íƒ','í”ŒëœíŠ¸','ë‰´ì—ë„ˆì§€'];
  document.querySelectorAll('#page-1 .filter-row .f-btn').forEach(b => {
    if (deptBtns.includes(b.textContent)) b.classList.remove('active');
  });
  btn.classList.add('active');
  renderDeptTrend(currentDeptMetric, dept);
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE 3 CHARTS
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function initP3Charts() {
  const years = ['\'16','\'17','\'18','\'19','\'20','\'21','\'22','\'23','\'24','\'25','\'26'];
  const misData = [43000,38000,36000,36000,34000,42000,45000,55000,62000,80000,83036];
  const cashData = [12000,9500,8000,7200,6800,5400,4200,3100,-2100,-5200,798]; // Net-Cash

  const dlP3 = {
    id:'p3DL',
    afterDatasetsDraw(chart) {
      const {ctx, chartArea:{top,bottom}} = chart;
      ctx.save();
      chart.data.datasets.forEach((ds,di) => {
        const meta = chart.getDatasetMeta(di);
        meta.data.forEach((bar,idx) => {
          const v = ds.data[idx];
          if (v === undefined || v === null) return;
          ctx.font = 'bold 9px "Noto Sans KR"';
          ctx.textAlign = 'center';
          ctx.fillStyle = v < 0 ? '#ef4444' : '#1e293b';
          const dispV = Math.abs(v) >= 10000 ? (v/10000).toFixed(0)+'ë§Œ' : Math.abs(v) >= 1000 ? (v/1000).toFixed(1)+'k' : v;
          const labelY = v < 0 ? bar.y + 12 : bar.y - 6;
          if (labelY > top && labelY < bottom) ctx.fillText(dispV, bar.x, labelY);
        });
      });
      ctx.restore();
    }
  };

  mkChart('mis-trend-chart', {
    type:'bar',
    data:{labels:years, datasets:[{data:misData, backgroundColor:misData.map((v,i)=>i===10?'#1a56db':'rgba(59,130,246,0.5)'), borderRadius:3}]},
    plugins:[dlP3],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{ legend:{display:false}, tooltip:{...tooltipDefaults, callbacks:{
        label: ctx => `ë¯¸ìˆ˜ì±„ê¶Œ: ${ctx.parsed.y.toLocaleString()}ì–µì›`
      }}},
      scales:{ x:{grid:{display:false},ticks:{...defaultFont,color:'#94a3b8'}},
               y:{grid:{color:gridColor},ticks:{...defaultFont,color:'#94a3b8',callback:v=>v>=10000?(v/10000).toFixed(0)+'ë§Œ':v},beginAtZero:true} }
    }
  });

  mkChart('cash-trend-chart', {
    type:'bar',
    data:{labels:years, datasets:[{data:cashData, backgroundColor:cashData.map(v=>v<0?'rgba(239,68,68,0.7)':'rgba(16,185,129,0.7)'), borderRadius:3}]},
    plugins:[dlP3],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{ legend:{display:false}, tooltip:{...tooltipDefaults, callbacks:{
        label: ctx => `Net-Cash: ${ctx.parsed.y.toLocaleString()}ì–µì›`
      }}},
      scales:{ x:{grid:{display:false},ticks:{...defaultFont,color:'#94a3b8'}},
               y:{grid:{color:gridColor},ticks:{...defaultFont,color:'#94a3b8',callback:v=>v>=1000|v<=-1000?(v/1000).toFixed(0)+'k':v}} }
    }
  });
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE 4 CHARTS (REAL DATA)
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function initP4Charts() {
  // Fill dynamic values
  document.getElementById('pf-total-val').textContent = PF_DATA.total.toLocaleString();
  document.getElementById('jb-val').textContent = Math.round(PF_DATA.jb_current).toLocaleString();
  document.getElementById('cp-val').textContent = Math.round(PF_DATA.cp_current).toLocaleString();
  document.getElementById('jb-prev-diff').textContent = fmt(PF_DATA.jb_current - PF_DATA.jb_prev);
  document.getElementById('jb-yr-diff').textContent = fmt(PF_DATA.jb_current - PF_DATA.jb_prev_yr);
  document.getElementById('cp-prev-diff').textContent = fmt(PF_DATA.cp_current - PF_DATA.cp_prev);
  document.getElementById('cp-yr-diff').textContent = fmt(PF_DATA.cp_current - PF_DATA.cp_prev_yr);
  document.getElementById('pf-vs-prev').textContent = `ì „ì›”ë¹„ ${fmt(PF_DATA.total - PF_DATA.total_prev)}`;
  document.getElementById('pf-vs-yr').textContent = `ì „ë…„ë¹„ ${fmt(PF_DATA.total - PF_DATA.total_prev_yr)}`;

  // CP sites table
  const tbody = document.getElementById('cp-sites-tbody');
  tbody.innerHTML = PF_DATA.cp_sites.map(s => {
    const expDate = new Date(s.expiry), now = new Date('2026-01-31');
    const daysLeft = Math.round((expDate - now) / 86400000);
    const urgency = daysLeft < 60 ? 's-bad' : daysLeft < 180 ? 's-warn' : 's-ok';
    return `<tr class="tt-trigger" data-tt="p4-cp" style="cursor:pointer;">
      <td>${s.name}</td><td>${s.expiry}</td>
      <td class="txt-blue" style="font-weight:700;">${s.amount_ì–µ.toLocaleString()}</td>
      <td><span class="status ${urgency}">${daysLeft<0?'ë§Œê¸°':'D-'+daysLeft}</span></td>
    </tr>`;
  }).join('');
  // rebind after DOM update
  setTimeout(bindTooltips, 50);

  const dlP4 = {
    id:'p4DL',
    afterDatasetsDraw(chart) {
      const {ctx, chartArea:{top,bottom}} = chart;
      ctx.save();
      chart.data.datasets.forEach((ds,di) => {
        const meta = chart.getDatasetMeta(di);
        if (meta.hidden) return;
        meta.data.forEach((el,idx) => {
          const v = ds.data[idx];
          if (v === undefined || v === null) return;
          ctx.font = 'bold 9px "Noto Sans KR"';
          ctx.textAlign = 'center';
          ctx.fillStyle = '#1e293b';
          const dispV = v >= 10000 ? (v/10000).toFixed(0)+'ë§Œ' : v >= 1000 ? (v/1000).toFixed(0)+'k' : v;
          const isLine = ds.type === 'line' || (!ds.type && (chart.config.type === 'line'));
          const labelY = isLine ? el.y - 9 : el.y - 6;
          if (labelY > top && labelY < bottom) ctx.fillText(dispV, el.x, labelY);
        });
      });
      ctx.restore();
    }
  };

  // Region donut
  const reg = PF_DATA.region;
  mkChart('region-donut-chart', {
    type:'doughnut',
    data:{ labels:Object.keys(reg), datasets:[{data:Object.values(reg), backgroundColor:['#3b82f6','#f59e0b','#8b5cf6','#94a3b8','#e5e7eb'], borderWidth:2, borderColor:'#fff'}]},
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{
        legend:{position:'right',labels:{...defaultFont,boxWidth:10,padding:5}},
        tooltip:{...tooltipDefaults, callbacks:{label:ctx=>`${ctx.label}: ${ctx.parsed.toLocaleString()}ì–µ (${((ctx.parsed/PF_DATA.jb_current)*100).toFixed(0)}%)`}}
      },
      cutout:'60%'
    }
  });

  // Equity ratio
  const equityYears = ['\'22','\'23','\'24','\'25','\'26.01'];
  const jbAmts = [92678, 109874, 123966, 123522, 131443]; // ì‹¤ë°ì´í„°
  const eqCapital = [85000,88000,90000,96000,101000];
  const ratioData = jbAmts.map((v,i) => ((v/eqCapital[i])*100).toFixed(1));
  mkChart('equity-ratio-chart', {
    type:'line',
    data:{labels:equityYears, datasets:[{
      label:'ì§€ê¸‰ë³´ì¦/ìê¸°ìë³¸(%)', data:ratioData,
      borderColor:'#ef4444', backgroundColor:'rgba(239,68,68,0.08)',
      fill:true, tension:0.4, pointRadius:5, pointBackgroundColor:'#ef4444',
    }]},
    plugins:[dlP4],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{legend:{display:false}, tooltip:{...tooltipDefaults, callbacks:{
        label:ctx=>`ìê¸°ìë³¸ëŒ€ë¹„: ${ctx.parsed.y}%`,
        afterLabel:ctx=>`ì§€ê¸‰ë³´ì¦: ${jbAmts[ctx.dataIndex].toLocaleString()}ì–µ`
      }}},
      scales:{x:{grid:{display:false},ticks:{...defaultFont,color:'#94a3b8'}},y:{grid:{color:gridColor},ticks:{...defaultFont,color:'#94a3b8',callback:v=>v+'%'}}}
    }
  });

  // Expiry bar
  const expiryKeys = Object.keys(PF_DATA.expiry);
  const expiryVals = Object.values(PF_DATA.expiry);
  mkChart('expiry-chart', {
    type:'bar',
    data:{labels:expiryKeys, datasets:[{
      data:expiryVals,
      backgroundColor: expiryVals.map((v,i)=>i<2?'rgba(239,68,68,0.8)':i<4?'rgba(245,158,11,0.8)':'rgba(59,130,246,0.7)'),
      borderRadius:3
    }]},
    plugins:[dlP4],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{
        legend:{display:false},
        tooltip:{...tooltipDefaults, callbacks:{
          title:ctx=>`ë§Œê¸°: ${ctx[0].label}`,
          label:ctx=>`ë³´ì¦ê¸ˆì•¡: ${ctx.parsed.y.toLocaleString()}ì–µ`,
          afterBody:() => {
            const site = PF_DATA.cp_sites.slice(0,3).map(s=>`  â€¢ ${s.name}: ${s.amount_ì–µ.toLocaleString()}ì–µ (ë§Œê¸°: ${s.expiry})`).join('\n');
            return '\nì£¼ìš” í˜„ì¥ ì°¸ê³ :\n' + site;
          }
        }}
      },
      scales:{x:{grid:{display:false},ticks:{...defaultFont,color:'#94a3b8'}},y:{grid:{color:gridColor},ticks:{...defaultFont,color:'#94a3b8',callback:v=>v>=10000?(v/10000).toFixed(0)+'ë§Œ':v},beginAtZero:true}}
    }
  });

  // PF trend
  const trendLabels = PF_DATA.trend.map(t=>t.d);
  mkChart('pf-trend-chart', {
    type:'line',
    data:{labels:trendLabels, datasets:[
      {label:'ì§€ê¸‰ë³´ì¦', data:PF_DATA.trend.map(t=>t.jb), borderColor:'#3b82f6', backgroundColor:'rgba(59,130,246,0.1)', fill:true, tension:0.3, pointRadius:2},
      {label:'ì±…ì„ì¤€ê³µ', data:PF_DATA.trend.map(t=>t.cp), borderColor:'#8b5cf6', backgroundColor:'rgba(139,92,246,0.05)', fill:true, tension:0.3, pointRadius:2},
    ]},
    plugins:[dlP4],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{legend:{display:false}, tooltip:{...tooltipDefaults, callbacks:{
        title:ctx=>`${ctx[0].label} ìš°ë°œë¶€ì±„`,
        label:ctx=>`${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString()}ì–µ`
      }}},
      scales:{
        x:{grid:{display:false},ticks:{...defaultFont,color:'#94a3b8',maxTicksLimit:8}},
        y:{grid:{color:gridColor},ticks:{...defaultFont,color:'#94a3b8',callback:v=>(v/10000).toFixed(1)+'ë§Œ'}}
      }
    }
  });
}

function fmt(v) {
  if (v > 0) return '+' + Math.round(v).toLocaleString();
  return 'â–³' + Math.abs(Math.round(v)).toLocaleString();
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE 5 CHARTS
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const costData = {
  'ì „ì²´': { years:['\'17','\'18','\'19','\'20','\'21','\'22','\'23','\'24','\'25','\'26'], data:[-4676,-5139,-5187,-5506,-300,-1111,-1276,-3490,-1881,-402] },
  'í† ëª©':  { years:['\'17','\'18','\'19','\'20','\'21','\'22','\'23','\'24','\'25','\'26'], data:[-1200,-1350,-1400,-1500,-80,-200,-300,-800,-500,-4] },
  'ê±´ì¶•':  { years:['\'17','\'18','\'19','\'20','\'21','\'22','\'23','\'24','\'25','\'26'], data:[-200,-250,-300,-350,-50,-100,-120,-250,-200,-373] },
  'ì£¼íƒ':  { years:['\'17','\'18','\'19','\'20','\'21','\'22','\'23','\'24','\'25','\'26'], data:[500,600,700,800,200,300,400,600,500,-25] },
  'í”ŒëœíŠ¸':{ years:['\'17','\'18','\'19','\'20','\'21','\'22','\'23','\'24','\'25','\'26'], data:[-3800,-4100,-4200,-4500,-370,-1100,-1250,-3000,-1700,0] },
  'ë‰´ì—ë„ˆì§€':{ years:['\'17','\'18','\'19','\'20','\'21','\'22','\'23','\'24','\'25','\'26'], data:[0,0,0,0,-10,-20,-50,-100,-80,1] },
};

// ì›ê°€ìœ¨ í˜„ì¥ë³„ ìƒì„¸ (íˆ´íŒìš©)
const costSiteDetailsMap = {
  'ì „ì²´': {
    '\'26': [{name:'GBC ì‹ ì¶•ê³µì‚¬',result:'ì•…í™”',prevCost:'88.1%',curCost:'91.0%',effect:-98},{name:'AABA SKì˜¨',result:'ì•…í™”',prevCost:'90.1%',curCost:'93.3%',effect:-82},{name:'CABJ (ê±´ì¶•)',result:'ì•…í™”',prevCost:'101.5%',curCost:'103.2%',effect:-180},{name:'íìŠ¤ ë¼êµ° ì¸ í…Œë¼ìŠ¤',result:'ì•…í™”',prevCost:'88.0%',curCost:'91.8%',effect:-42},{name:'íìŠ¤ ì„ í™”',result:'ê°œì„ ',prevCost:'63.5%',curCost:'60.6%',effect:12}],
    '\'25': [{name:'AABA SKì˜¨',result:'ì•…í™”',prevCost:'88.0%',curCost:'90.1%',effect:-820},{name:'GBC ì‹ ì¶•',result:'ì•…í™”',prevCost:'86.0%',curCost:'88.1%',effect:-380},{name:'íìŠ¤ ì´ìˆ˜ì—­',result:'ê°œì„ ',prevCost:'88.5%',curCost:'86.4%',effect:95}],
  },
  'ê±´ì¶•': {
    '\'26': [{name:'GBC ì‹ ì¶•ê³µì‚¬',result:'ì•…í™”',prevCost:'88.1%',curCost:'91.0%',effect:-98},{name:'AABA SKì˜¨',result:'ì•…í™”',prevCost:'90.1%',curCost:'93.3%',effect:-82},{name:'CABJ',result:'ì•…í™”',prevCost:'101.5%',curCost:'103.2%',effect:-180},{name:'AWS DC',result:'ê°œì„ ',prevCost:'90.1%',curCost:'88.5%',effect:13}],
  },
  'ì£¼íƒ': {
    '\'26': [{name:'íìŠ¤ ì„ í™”',result:'ê°œì„ ',prevCost:'63.5%',curCost:'60.6%',effect:12},{name:'íìŠ¤ ë™ëŒ€êµ¬',result:'ì•…í™”',prevCost:'89.5%',curCost:'91.2%',effect:-21},{name:'íìŠ¤ ë‘”ì‚°',result:'ì•…í™”',prevCost:'84.0%',curCost:'86.4%',effect:-16}],
  },
};

const dlP5 = {
  id:'p5DL',
  afterDatasetsDraw(chart) {
    const {ctx, chartArea:{top,bottom}} = chart;
    ctx.save();
    chart.data.datasets.forEach((ds,di) => {
      const meta = chart.getDatasetMeta(di);
      meta.data.forEach((bar,idx) => {
        const v = ds.data[idx];
        if (v === null || v === undefined || v === 0) return;
        ctx.font = 'bold 9px "Noto Sans KR"';
        ctx.textAlign = 'center';
        ctx.fillStyle = v < 0 ? '#dc2626' : '#16a34a';
        const dispV = (v>0?'+':'')+v.toLocaleString();
        const labelY = v < 0 ? bar.y + 12 : bar.y - 6;
        if (labelY > top && labelY < bottom) ctx.fillText(dispV, bar.x, labelY);
      });
    });
    ctx.restore();
  }
};

let currentCostFilter = 'ì „ì²´';
function initP5Charts() { renderCostChart('ì „ì²´'); }

function renderCostChart(filter) {
  currentCostFilter = filter;
  const d = costData[filter];
  mkChart('cost-trend-chart', {
    type:'bar',
    data:{ labels:d.years, datasets:[{
      data:d.data,
      backgroundColor: d.data.map(v=>v>=0?'rgba(16,185,129,0.75)':'rgba(239,68,68,0.75)'),
      borderRadius:3
    }]},
    plugins:[dlP5],
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{
        legend:{display:false},
        tooltip:{
          ...tooltipDefaults,
          callbacks:{
            title: ctx => `${ctx[0].label}ë…„ ì›ê°€ìœ¨ ì¦ê° (${filter})`,
            label: ctx => `ì†ìµíš¨ê³¼: ${ctx.parsed.y.toLocaleString()}ì–µ (${ctx.parsed.y>=0?'ê°œì„ ':'ì•…í™”'})`,
            afterBody: ctx => {
              const yr = ctx[0].label;
              const det = (costSiteDetailsMap[filter]||costSiteDetailsMap['ì „ì²´'])[yr];
              if (!det || !det.length) return '';
              return '\nì£¼ìš” í˜„ì¥:\n' +
                det.map(s=>`  [${s.result==='ê°œì„ '?'â†‘ê°œì„ ':'â†“ì•…í™”'}] ${s.name}\n  ì „ë…„ ${s.prevCost} â†’ ì‹¤ì  ${s.curCost} | íš¨ê³¼ ${s.effect>0?'+':''}${s.effect}ì–µ`).join('\n');
            }
          }
        }
      },
      scales:{
        x:{grid:{display:false},ticks:{...defaultFont,color:'#94a3b8'}},
        y:{grid:{color:gridColor},ticks:{...defaultFont,color:'#94a3b8',callback:v=>v.toLocaleString()}}
      }
    }
  });
}

function setCostFilter(filter, btn) {
  document.querySelectorAll('#page-4 .filter-row .f-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderCostChart(filter);
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE 6: SITE TABLE
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const siteData = [
  {name:'íìŠ¤í…Œì´íŠ¸ ë” ì™€ì´ì¦ˆ ì„ í™”',dept:'ì£¼íƒ',region:'êµ­ë‚´',contract:4218,prog:'59.8%',sales:51,cost:'60.6%',mis:358,pf:''},
  {name:'GTX-B 1ê³µêµ¬',dept:'í† ëª©',region:'êµ­ë‚´',contract:2638,prog:'4.2%',sales:11,cost:'88.0%',mis:71,pf:''},
  {name:'GTX-B 4ê³µêµ¬',dept:'í† ëª©',region:'êµ­ë‚´',contract:1880,prog:'5.1%',sales:4,cost:'91.8%',mis:23,pf:''},
  {name:'GBC ì‹ ì¶•ê³µì‚¬',dept:'ê±´ì¶•',region:'êµ­ë‚´',contract:17923,prog:'8.0%',sales:34,cost:'91.0%',mis:139,pf:''},
  {name:'GBC ê³µê³µê¸°ì—¬(ì ì‹¤)',dept:'ê±´ì¶•',region:'êµ­ë‚´',contract:2029,prog:'65.8%',sales:82,cost:'86.4%',mis:294,pf:''},
  {name:'AWS ë°ì´í„°ì„¼í„°',dept:'ê±´ì¶•',region:'êµ­ë‚´',contract:2373,prog:'49.9%',sales:84,cost:'88.5%',mis:175,pf:''},
  {name:'BKES',dept:'ê±´ì¶•',region:'êµ­ë‚´',contract:2356,prog:'67.0%',sales:51,cost:'60.6%',mis:358,pf:''},
  {name:'AABA (SKì˜¨ ë°°í„°ë¦¬)',dept:'ê±´ì¶•',region:'í•´ì™¸',contract:12214,prog:'89.5%',sales:25,cost:'93.3%',mis:-749,pf:''},
  {name:'CABJ',dept:'ê±´ì¶•',region:'í•´ì™¸',contract:9695,prog:'80.2%',sales:97,cost:'103.2%',mis:0,pf:''},
  {name:'Actis íŒ€ë¶íˆ¬ ë°ì´í„°ì„¼í„°',dept:'í”ŒëœíŠ¸',region:'í•´ì™¸',contract:7340,prog:'3.9%',sales:30,cost:'89.8%',mis:89,pf:'ì±…ì„ì¤€ê³µ'},
  {name:'ALOM ì•Œì œë¦¬',dept:'í”ŒëœíŠ¸',region:'í•´ì™¸',contract:7583,prog:'60.5%',sales:26,cost:'82.4%',mis:1871,pf:''},
  {name:'HOUN',dept:'í”ŒëœíŠ¸',region:'í•´ì™¸',contract:4725,prog:'90.1%',sales:96,cost:'94.2%',mis:328,pf:''},
  {name:'25-F-Kì§€ì—­ ì‹œì„¤ê³µì‚¬',dept:'í”ŒëœíŠ¸',region:'í•´ì™¸',contract:4525,prog:'0.1%',sales:4,cost:'87.4%',mis:6,pf:''},
  {name:'íìŠ¤ ë¼êµ° ì¸ ì œì£¼',dept:'ì£¼íƒ',region:'êµ­ë‚´',contract:3210,prog:'83.5%',sales:45,cost:'86.0%',mis:520,pf:'ì±…ì„ì¤€ê³µ'},
  {name:'íìŠ¤ ë™ëŒ€êµ¬ ì„¼íŠ¸ëŸ´',dept:'ì£¼íƒ',region:'êµ­ë‚´',contract:2180,prog:'96.6%',sales:25,cost:'91.2%',mis:180,pf:''},
];

let siteFilters = {'êµ­ë‚´ì™¸':'all','ë³¸ë¶€':'all'};
let siteSearch = '';

function renderSiteTable() {
  const tbody = document.getElementById('site-tbody');
  const filtered = siteData.filter(s => {
    if (siteFilters['êµ­ë‚´ì™¸'] !== 'all' && s.region !== siteFilters['êµ­ë‚´ì™¸']) return false;
    if (siteFilters['ë³¸ë¶€'] !== 'all' && s.dept !== siteFilters['ë³¸ë¶€']) return false;
    if (siteSearch && !s.name.includes(siteSearch)) return false;
    return true;
  });
  tbody.innerHTML = filtered.map(s => {
    const cost = parseFloat(s.cost);
    const costCls = cost > 100 ? 'txt-dn' : cost > 95 ? 'txt-gold' : 'txt-up';
    return `<tr>
      <td>${s.name}</td>
      <td>${s.dept}</td>
      <td><span class="cb ${s.region==='í•´ì™¸'?'cb-blue':'cb-green'}">${s.region}</span></td>
      <td>${s.contract.toLocaleString()}</td>
      <td>${s.prog}</td>
      <td>${s.sales}</td>
      <td class="${costCls}">${s.cost}</td>
      <td class="${s.mis < 0 ? 'txt-dn':''}">${s.mis.toLocaleString()}</td>
      <td>${s.pf ? `<span class="cb cb-red">${s.pf}</span>` : 'â€”'}</td>
    </tr>`;
  }).join('');
}

function filterSite(type, val, btn) {
  const grpMap = {'êµ­ë‚´ì™¸':['ì „ì²´','êµ­ë‚´','í•´ì™¸'], 'ë³¸ë¶€':['ì „ì²´','í† ëª©','ê±´ì¶•','ì£¼íƒ','í”ŒëœíŠ¸','ë‰´ì—ë„ˆì§€']};
  // Reset buttons in same group
  document.querySelectorAll('#page-5 .filter-row .f-btn').forEach(b => {
    if (grpMap[type].includes(b.textContent)) b.classList.remove('active');
  });
  btn.classList.add('active');
  siteFilters[type] = val;
  renderSiteTable();
}

function searchSite(v) { siteSearch = v; renderSiteTable(); }
renderSiteTable();

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE 7: ì—°ê²°ì‹¤ì 
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const p7Data = {
  'ë³„ë„': [
    {l:'ë§¤ì¶œ',q:'41,250',qPrev:'43,426',cum:'165,125',cumPrev:'167,301'},
    {l:'ì˜ì—…ì´ìµ',q:'1,155',qPrev:'710',cum:'2,512',cumPrev:'-2,155'},
    {l:'ì˜ì—…ì´ìµë¥ ',q:'2.8%',qPrev:'1.6%',cum:'1.5%',cumPrev:'-1.3%'},
    {l:'ê²½ìƒì´ìµ',q:'648',qPrev:'490',cum:'2,765',cumPrev:'-337'},
    {l:'ê²½ìƒì´ìµë¥ ',q:'1.6%',qPrev:'1.1%',cum:'1.7%',cumPrev:'-0.2%'},
    {l:'ë‹¹ê¸°ìˆœì´ìµ',q:'506',qPrev:'380',cum:'2,313',cumPrev:'-418'},
  ],
  'ì—°ê²°': [
    {l:'ë§¤ì¶œ',q:'80,601',qPrev:'78,210',cum:'310,629',cumPrev:'302,840'},
    {l:'ì˜ì—…ì´ìµ',q:'1,188',qPrev:'920',cum:'6,530',cumPrev:'4,210'},
    {l:'ì˜ì—…ì´ìµë¥ ',q:'3.2%',qPrev:'2.4%',cum:'2.1%',cumPrev:'1.4%'},
    {l:'ê²½ìƒì´ìµ',q:'1,574',qPrev:'1,180',cum:'6,468',cumPrev:'4,010'},
    {l:'ê²½ìƒì´ìµë¥ ',q:'2.0%',qPrev:'1.5%',cum:'2.1%',cumPrev:'1.3%'},
    {l:'ë‹¹ê¸°ìˆœì´ìµ',q:'1,659',qPrev:'1,200',cum:'5,591',cumPrev:'3,850'},
  ]
};

function setP7(mode) {
  document.getElementById('p7-sep-btn').className = 'tab-btn ' + (mode==='ë³„ë„'?'active':'');
  document.getElementById('p7-con-btn').className = 'tab-btn ' + (mode==='ì—°ê²°'?'active':'');
  document.getElementById('p7-sep-btn').style.cssText = 'border:1px solid var(--border);border-radius:var(--radius-sm);';
  document.getElementById('p7-con-btn').style.cssText = 'border:1px solid var(--border);border-radius:var(--radius-sm);';

  const d = p7Data[mode];
  const tbody = document.getElementById('p7-tbody');
  tbody.innerHTML = d.map(r => {
    const isPct = r.l.includes('ë¥ ');
    return `<tr ${!isPct ? 'class="group"' : ''}>
      <td style="padding-left:${isPct?'20':'12'}px;font-size:${isPct?'11':'13'}px;">${r.l}</td>
      <td class="${isPct?'txt-muted':''}">${r.q}</td>
      <td class="txt-muted">${r.qPrev}</td>
      <td></td>
      <td class="${isPct?'txt-muted txt-gold':'txt-gold'}">${r.cum}</td>
      <td class="txt-muted">${r.cumPrev}</td>
      <td></td>
    </tr>`;
  }).join('');

  document.getElementById('p7-yoy-title').textContent = `ì „ë…„ë™ê¸°ë¹„ â€” ${mode} ê¸°ì¤€`;
}

setP7('ë³„ë„');

function initP7Charts() {
  mkChart('op-margin-chart', {
    type: 'line',
    data: {
      labels: ['4Q24','1Q25','2Q25','3Q25','4Q25','1Q26'],
      datasets: [
        { label:'ë³„ë„', data:[4.8,3.2,4.1,3.8,5.7,2.8], borderColor:'#3b82f6', tension:0.4, pointRadius:3 },
        { label:'ì—°ê²°', data:[3.5,2.8,3.6,3.2,4.2,3.2], borderColor:'#f59e0b', tension:0.4, pointRadius:3 },
      ]
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: { legend: { display: true, labels: { ...defaultFont, boxWidth:10 } }, tooltip: { ...tooltipDefaults, callbacks: { label: ctx => ctx.dataset.label+': '+ctx.parsed.y+'%' } } },
      scales: {
        x: { grid: { display: false }, ticks: { ...defaultFont, color: '#94a3b8' } },
        y: { grid: { color: gridColor }, ticks: { ...defaultFont, color: '#94a3b8', callback: v => v+'%' } }
      }
    }
  });
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE 8: ì¬ë¬´ì œí‘œ
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const p8Data = {
  'ì—°ê²°': {
    debtRatio:'174.8%', curRatio:'147.9%', eqRatio:'36.4%',
    debtBadge:'ì „ë…„ë¹„ â–³4.5%p', curBadge:'ì „ë…„ë¹„ +4.0%p', eqBadge:'ì „ë…„ë¹„ +1.2%p',
    assetTitle:'ìì‚° (ì—°ê²°)', liabTitle:'ë¶€ì±„Â·ìë³¸ (ì—°ê²°)',
    totalAsset:'277,917ì–µ', curAsset:'219,580ì–µ', recv:'107,797ì–µ (+15,232)',
    cash:'51,769ì–µ (â–³2,195)', noncur:'58,337ì–µ',
    totalLiab:'176,787ì–µ', stDebt:'+4,038ì–µ ì¦ê°€', over:'98,612ì–µ (â–³2,761)',
    equity:'101,129ì–µ', retained:'64,033ì–µ (+2,731)',
  },
  'ë³„ë„': {
    debtRatio:'165.2%', curRatio:'152.1%', eqRatio:'37.7%',
    debtBadge:'ì „ë…„ë¹„ â–³3.2%p', curBadge:'ì „ë…„ë¹„ +3.5%p', eqBadge:'ì „ë…„ë¹„ +0.9%p',
    assetTitle:'ìì‚° (ë³„ë„)', liabTitle:'ë¶€ì±„Â·ìë³¸ (ë³„ë„)',
    totalAsset:'218,450ì–µ', curAsset:'172,320ì–µ', recv:'85,100ì–µ (+12,800)',
    cash:'42,100ì–µ (â–³1,800)', noncur:'46,130ì–µ',
    totalLiab:'135,200ì–µ', stDebt:'+3,100ì–µ ì¦ê°€', over:'75,400ì–µ (â–³2,200)',
    equity:'83,250ì–µ', retained:'52,400ì–µ (+2,100)',
  }
};

function setP8(mode) {
  document.getElementById('p8-con-btn').className = 'tab-btn ' + (mode==='ì—°ê²°'?'active':'');
  document.getElementById('p8-sep-btn').className = 'tab-btn ' + (mode==='ë³„ë„'?'active':'');
  document.getElementById('p8-con-btn').style.cssText = 'border:1px solid var(--border);border-radius:var(--radius-sm);';
  document.getElementById('p8-sep-btn').style.cssText = 'border:1px solid var(--border);border-radius:var(--radius-sm);';
  const d = p8Data[mode];
  document.getElementById('p8-debt-ratio').textContent = d.debtRatio;
  document.getElementById('p8-cur-ratio').textContent = d.curRatio;
  document.getElementById('p8-eq-ratio').textContent = d.eqRatio;
  document.getElementById('p8-debt-badge').textContent = d.debtBadge;
  document.getElementById('p8-cur-badge').textContent = d.curBadge;
  document.getElementById('p8-eq-badge').textContent = d.eqBadge;
  document.getElementById('p8-asset-title').textContent = d.assetTitle;
  document.getElementById('p8-liab-title').textContent = d.liabTitle;
  document.getElementById('p8-total-asset').textContent = d.totalAsset;
  document.getElementById('p8-cur-asset').textContent = d.curAsset;
  document.getElementById('p8-recv').textContent = d.recv;
  document.getElementById('p8-cash').textContent = d.cash;
  document.getElementById('p8-noncur').textContent = d.noncur;
  document.getElementById('p8-total-liab').textContent = d.totalLiab;
  document.getElementById('p8-st-debt').textContent = d.stDebt;
  document.getElementById('p8-over').textContent = d.over;
  document.getElementById('p8-equity').textContent = d.equity;
  document.getElementById('p8-retained').textContent = d.retained;
}

function initP8Charts() {
  mkChart('p8-debt-chart', {
    type: 'line',
    data: {
      labels: ['\'21','\'22','\'23','\'24','\'25','\'26.01'],
      datasets: [
        { label:'ì—°ê²°', data:[145,158,171,179,174,175], borderColor:'#3b82f6', tension:0.4, pointRadius:3 },
        { label:'ë³„ë„', data:[132,145,160,168,165,165], borderColor:'#f59e0b', tension:0.4, pointRadius:3 },
      ]
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: { legend: { display: true, labels: { ...defaultFont, boxWidth:10 } }, tooltip: { ...tooltipDefaults, callbacks: { label: ctx => ctx.dataset.label+': '+ctx.parsed.y+'%' } } },
      scales: {
        x: { grid: { display: false }, ticks: { ...defaultFont, color: '#94a3b8' } },
        y: { grid: { color: gridColor }, ticks: { ...defaultFont, color: '#94a3b8', callback: v => v+'%' }, min:100 }
      }
    }
  });
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// PAGE 9: ê²½ìŸì‚¬
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function initP9Charts() {
  mkChart('comp-chart', barConfig(
    ['í˜„ëŒ€ê±´ì„¤','GSê±´ì„¤','ì‚¼ì„±E&A','ëŒ€ìš°ê±´ì„¤','DL E&C','ì‚¼ì„±ë¬¼ì‚°'],
    [{
      label: 'ì˜ì—…ì´ìµë¥ (%)',
      data: [1.5, 1.7, 5.0, 3.5, 2.3, 4.1],
      backgroundColor: ['#3b82f6','#94a3b8','#94a3b8','#94a3b8','#94a3b8','#94a3b8'],
      borderRadius: 4,
    }],
    { pct: true }
  ));
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// INIT
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// Init page 0 charts
setTimeout(() => {
  initPageCharts(0);
  bindTooltips();
}, 100);
// Init page 3 (PF) data rendering
setTimeout(() => {
  const tbody = document.getElementById('cp-sites-tbody');
  if (tbody && tbody.innerHTML === '') {
    tbody.innerHTML = PF_DATA.cp_sites.map(s => {
      const expDate = new Date(s.expiry);
      const now = new Date('2026-01-31');
      const daysLeft = Math.round((expDate - now) / 86400000);
      const urgency = daysLeft < 60 ? 's-bad' : daysLeft < 180 ? 's-warn' : 's-ok';
      return `<tr><td>${s.name}</td><td>${s.expiry}</td><td class="txt-blue" style="font-weight:700;">${s.amount_ì–µ.toLocaleString()}</td><td><span class="status ${urgency}">${daysLeft<0?'ë§Œê¸°':'D-'+daysLeft}</span></td></tr>`;
    }).join('');
    document.getElementById('pf-total-val').textContent = PF_DATA.total.toLocaleString();
    document.getElementById('jb-val').textContent = Math.round(PF_DATA.jb_current).toLocaleString();
    document.getElementById('cp-val').textContent = Math.round(PF_DATA.cp_current).toLocaleString();
    document.getElementById('jb-prev-diff').textContent = fmt(PF_DATA.jb_current - PF_DATA.jb_prev);
    document.getElementById('jb-yr-diff').textContent = fmt(PF_DATA.jb_current - PF_DATA.jb_prev_yr);
    document.getElementById('cp-prev-diff').textContent = fmt(PF_DATA.cp_current - PF_DATA.cp_prev);
    document.getElementById('cp-yr-diff').textContent = fmt(PF_DATA.cp_current - PF_DATA.cp_prev_yr);
    document.getElementById('pf-vs-prev').textContent = `ì „ì›”ë¹„ ${fmt(PF_DATA.total - PF_DATA.total_prev)}`;
    document.getElementById('pf-vs-yr').textContent = `ì „ë…„ë¹„ ${fmt(PF_DATA.total - PF_DATA.total_prev_yr)}`;
  }
}, 200);
</script>
</body>
</html>
